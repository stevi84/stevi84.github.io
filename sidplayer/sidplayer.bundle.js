(()=>{"use strict";var e,t,a,i,s={27:(e,t,a)=>{a.d(t,{Ax:()=>m,Lo:()=>T,Qq:()=>V,Rl:()=>p,Wi:()=>g,br:()=>f,hz:()=>w,pu:()=>i});const i=.0587253835466173,s=e=>1<<31-Math.clz32(e);class n{_audioContext;_values=[];_defaultValue;constructor(e,t){this._audioContext=e,this._values.push({startTime:e.currentTime,value:t,interpolation:"const"}),this._defaultValue=t}setValueAtTime(e,t){if(t<this._values[0].startTime)this._values.unshift({startTime:t,value:e,interpolation:"const"});else if(t>=this._values[this._values.length-1].startTime)this._values.push({startTime:t,value:e,interpolation:"const"});else for(let a=0;a<this._values.length-1;a++)if(t>=this._values[a].startTime&&t<this._values[a+1].startTime){this._values.splice(a+1,0,{startTime:t,value:e,interpolation:"const"});break}return this}getValueAtTime(e){if(e<this._values[0].startTime)return this._defaultValue;let t;if(1===this._values.length)t=this._values[0];else{for(let a=0;a<this._values.length-1;a++)if(e>=this._values[a].startTime&&e<this._values[a+1].startTime){t=this._values[a];break}t||(t=this._values[this._values.length-1])}return"const"===t.interpolation?t.value:"lin"===t.interpolation?e<t.endTime?t.startValue+(e-t.startTime)/(t.endTime-t.startTime)*(t.endValue-t.startValue):t.endValue:t.endValue+(t.startValue-t.endValue)*Math.exp(-(e-t.startTime)/t.timeConstant)}get value(){return this.getValueAtTime(this._audioContext.currentTime)}set value(e){this.setValueAtTime(e,this._audioContext.currentTime)}cancelScheduledValues(e){const t=this._values.findIndex((t=>e<t.startTime));t>=0&&this._values.splice(t),0===this._values.length&&this._values.push({startTime:this._audioContext.currentTime,value:this._defaultValue,interpolation:"const"})}linearRampToValueAtTime(e,t){if(t<this._values[0].startTime);else if(t>=this._values[this._values.length-1].startTime){const a=this._values.pop();this._values.push({startTime:a.startTime,startValue:"const"===a.interpolation?a.value:a.startValue,endTime:t,endValue:e,interpolation:"lin"})}else for(let a=0;a<this._values.length-1;a++)if(t>=this._values[a].startTime&&t<this._values[a+1].startTime){const i=this._values.splice(a,1)[0];this._values.splice(a,0,{startTime:i.startTime,startValue:"const"===i.interpolation?i.value:i.startValue,endTime:t,endValue:e,interpolation:"lin"});break}return this}setTargetAtTime(e,t,a){if(t<this._values[0].startTime)this._values.unshift({startTime:t,startValue:this._defaultValue,endValue:e,timeConstant:a,interpolation:"exp"});else if(t>=this._values[this._values.length-1].startTime)this._values.push({startTime:t,startValue:this.getValueAtTime(t),endValue:e,timeConstant:a,interpolation:"exp"});else for(let i=0;i<this._values.length-1;i++)if(t>=this._values[i].startTime&&t<this._values[i+1].startTime){this._values.splice(i+1,0,{startTime:t,startValue:this.getValueAtTime(t),endValue:e,timeConstant:a,interpolation:"exp"});break}return this}}class r{_audioContext;_values=[];_defaultValue;constructor(e,t){this._audioContext=e,this._values.push({startTime:e.currentTime,value:t}),this._defaultValue=t}setValueAtTime(e,t){if(t<this._values[0].startTime)this._values.unshift({startTime:t,value:e});else if(t>=this._values[this._values.length-1].startTime)this._values.push({startTime:t,value:e});else for(let a=0;a<this._values.length-1;a++)if(t>=this._values[a].startTime&&t<this._values[a+1].startTime){this._values.splice(a+1,0,{startTime:t,value:e});break}return this}getValueAtTime(e){if(e<this._values[0].startTime)return this._defaultValue;let t;if(1===this._values.length)t=this._values[0];else{for(let a=0;a<this._values.length-1;a++)if(e>=this._values[a].startTime&&e<this._values[a+1].startTime){t=this._values[a];break}t||(t=this._values[this._values.length-1])}return t.value}get value(){return this.getValueAtTime(this._audioContext.currentTime)}set value(e){this.setValueAtTime(e,this._audioContext.currentTime)}cancelScheduledValues(e){const t=this._values.findIndex((t=>e<t.startTime));t>=0&&this._values.splice(t),0===this._values.length&&this._values.push({startTime:this._audioContext.currentTime,value:this._defaultValue})}}const l=e=>e<.5?4*e-1:3-4*e,u=e=>2*e-1,o=(e,t)=>e<t?-1:1;class c{_audioContext;_gain;_frequencyParameter;_widthParameter;_syncParameter;_rngParameter;_syncOffset;_oscillator;constructor(e,t,a){this._audioContext=e,this._gain=new GainNode(e,{gain:0}),this._frequencyParameter=new n(e,0),this._widthParameter=new n(e,.5),this._syncParameter=new r(e,!1),this._rngParameter=new r(e,!1),this._syncOffset=0;const i=s(Math.floor(e.sampleRate/60));let u=0,o=0,c=0;this._oscillator=e.createScriptProcessor(i,1,1),this._oscillator.onaudioprocess=s=>{const n=new Float32Array(i),r=this._frequencyParameter.value/e.sampleRate,h=this._widthParameter.value,_=this._syncParameter.value,d=this._rngParameter.value&&t===l,{frequency:m,offset:g}=a(),f=m/e.sampleRate;if(o=(c-g)*f,o-=Math.floor(o),0!==r)for(let e=0;e<i;e++){c++,o+=f;let a=d&&o>=.5?-1:1;o>=1&&(_&&(this._syncOffset=c-(o-1)/f,u=(o-1)/f*r),o-=Math.floor(o)),a*=t(u,h),n[e]=a,u+=r,u>=1&&(this._syncOffset=c-(u-1)/r,u-=Math.floor(u))}else n.fill(0);for(let e=0;e<s.outputBuffer.numberOfChannels;e++){const t=s.outputBuffer.getChannelData(e);for(let e=0;e<i;e++)t[e]=n[e]}},this._oscillator.connect(this._gain)}get frequency(){return this._frequencyParameter}get width(){return this._widthParameter}get sync(){return this._syncParameter}get rng(){return this._rngParameter}get syncOffset(){return this._syncOffset}start(e=this._audioContext.currentTime){this._gain.gain.cancelScheduledValues(e),this._gain.gain.setValueAtTime(1,e)}stop(e=this._audioContext.currentTime){this._gain.gain.cancelScheduledValues(e),this._gain.gain.setValueAtTime(0,e)}connect(e){this._gain.connect(e)}disconnect(){this._gain.disconnect()}reset(e=this._audioContext.currentTime){this._frequencyParameter.cancelScheduledValues(e),this._frequencyParameter.setValueAtTime(0,e),this._widthParameter.cancelScheduledValues(e),this._widthParameter.setValueAtTime(.5,e),this._syncParameter.cancelScheduledValues(e),this._syncParameter.setValueAtTime(!1,e),this._rngParameter.cancelScheduledValues(e),this._rngParameter.setValueAtTime(!1,e),this._syncOffset=0,this._gain.gain.cancelScheduledValues(e),this._gain.gain.setValueAtTime(0,e)}}class h{_audioContext;_gain;_frequencyParameter;_syncOffset;_oscillator;constructor(e){this._audioContext=e,this._gain=new GainNode(e,{gain:0}),this._frequencyParameter=new n(e,0),this._syncOffset=0;const t=s(Math.floor(e.sampleRate/60));let a=0,i=0,r=0,l=0;this._oscillator=e.createScriptProcessor(t,1,1),this._oscillator.onaudioprocess=s=>{const n=new Float32Array(t),u=this._frequencyParameter.value/e.sampleRate;for(let e=0;e<t;e++)n[e]=l,i+=16*u,i>=1&&(i-=Math.floor(i),l=2*Math.random()-1),a+=u,a>=1&&(this._syncOffset=r+(a-1)/u,a-=Math.floor(a)),r++;for(let e=0;e<s.outputBuffer.numberOfChannels;e++){const a=s.outputBuffer.getChannelData(e);for(let e=0;e<t;e++)a[e]=n[e]}},this._oscillator.connect(this._gain)}get frequency(){return this._frequencyParameter}get syncOffset(){return this._syncOffset}start(e=this._audioContext.currentTime){this._gain.gain.cancelScheduledValues(e),this._gain.gain.setValueAtTime(1,e)}stop(e=this._audioContext.currentTime){this._gain.gain.cancelScheduledValues(e),this._gain.gain.setValueAtTime(0,e)}connect(e){this._gain.connect(e)}disconnect(){this._gain.disconnect()}reset(e=this._audioContext.currentTime){this._frequencyParameter.cancelScheduledValues(e),this._frequencyParameter.setValueAtTime(0,e),this._syncOffset=0,this._gain.gain.cancelScheduledValues(e),this._gain.gain.setValueAtTime(0,e)}}class _{_audioContext;_adsrGain;_triangleOsc;_sawtoothOsc;_pulseOsc;_noiseOsc;_activeWaveforms;_attackDurationParameter;_decayDurationParameter;_sustainLevelParameter;_releaseDurationParameter;_adsrGainParameter;constructor(e,t){this._audioContext=e,this._adsrGain=new GainNode(e,{gain:0}),this._triangleOsc=new c(e,l,t),this._sawtoothOsc=new c(e,u,t),this._pulseOsc=new c(e,o,t),this._noiseOsc=new h(e),this._activeWaveforms=new r(e,[]),this._attackDurationParameter=new n(e,.002),this._decayDurationParameter=new n(e,.006),this._sustainLevelParameter=new n(e,0),this._releaseDurationParameter=new n(e,.006),this._adsrGainParameter=new n(e,0),this._triangleOsc.connect(this._adsrGain),this._sawtoothOsc.connect(this._adsrGain),this._pulseOsc.connect(this._adsrGain),this._noiseOsc.connect(this._adsrGain)}get triangleOscillator(){return this._triangleOsc}get sawtoothOscillator(){return this._sawtoothOsc}get pulseOscillator(){return this._pulseOsc}get noiseOscillator(){return this._noiseOsc}get syncFrequency(){if(0===this._activeWaveforms.value.length)return 0;switch(this._activeWaveforms.value[0]){case"triangle":return this._triangleOsc.frequency.value;case"sawtooth":return this._sawtoothOsc.frequency.value;case"pulse":return this._pulseOsc.frequency.value;case"noise":return this._noiseOsc.frequency.value}}get syncOffset(){if(0===this._activeWaveforms.value.length)return 0;switch(this._activeWaveforms.value[0]){case"triangle":return this._triangleOsc.syncOffset;case"sawtooth":return this._sawtoothOsc.syncOffset;case"pulse":return this._pulseOsc.syncOffset;case"noise":return this._noiseOsc.syncOffset}}c64Frequency(e,t=this._audioContext.currentTime){this.frequency(e*i,t)}frequency(e,t=this._audioContext.currentTime){this._triangleOsc.frequency.setValueAtTime(e,t),this._sawtoothOsc.frequency.setValueAtTime(e,t),this._pulseOsc.frequency.setValueAtTime(e,t),this._noiseOsc.frequency.setValueAtTime(e,t)}c64Waveform(e,t=this._audioContext.currentTime){const a=[];8&e&&a.push("noise"),4&e&&a.push("pulse"),2&e&&a.push("sawtooth"),1&e&&a.push("triangle"),this.waveform(a,t)}waveform(e,t=this._audioContext.currentTime){e.includes("triangle")?this._triangleOsc.start(t):this._triangleOsc.stop(t),e.includes("sawtooth")?this._sawtoothOsc.start(t):this._sawtoothOsc.stop(t),e.includes("pulse")?this._pulseOsc.start(t):this._pulseOsc.stop(t),e.includes("noise")?this._noiseOsc.start(t):this._noiseOsc.stop(t),this._activeWaveforms.setValueAtTime(e.slice(),t)}static timeTable=[.002,.008,.016,.024,.038,.056,.068,.08,.1,.25,.5,.8,1,3,5,8];c64AttackDuration(e,t=this._audioContext.currentTime){this.attackDuration(_.timeTable[e],t)}attackDuration(e,t=this._audioContext.currentTime){this._attackDurationParameter.setValueAtTime(e,t)}c64DecayDuration(e,t=this._audioContext.currentTime){this.decayDuration(3*_.timeTable[e],t)}decayDuration(e,t=this._audioContext.currentTime){this._decayDurationParameter.setValueAtTime(e,t)}c64SustainLevel(e,t=this._audioContext.currentTime){this.sustainLevel(e/15,t)}sustainLevel(e,t=this._audioContext.currentTime){this._sustainLevelParameter.setValueAtTime(e,t)}c64ReleaseDuration(e,t=this._audioContext.currentTime){this.releaseDuration(3*_.timeTable[e],t)}releaseDuration(e,t=this._audioContext.currentTime){this._releaseDurationParameter.setValueAtTime(e,t)}c64PulseWidth(e,t=this._audioContext.currentTime){this.pulseWidth(e/4095,t)}pulseWidth(e,t=this._audioContext.currentTime){this._pulseOsc.width.setValueAtTime(e,t)}c64Sync(e,t=this._audioContext.currentTime){this.sync(Boolean(e),t)}sync(e,t=this._audioContext.currentTime){this._triangleOsc.sync.setValueAtTime(e,t),this._sawtoothOsc.sync.setValueAtTime(e,t),this._pulseOsc.sync.setValueAtTime(e,t)}c64Rng(e,t=this._audioContext.currentTime){this.rng(Boolean(e),t)}rng(e,t=this._audioContext.currentTime){this._triangleOsc.rng.setValueAtTime(e,t),this._sawtoothOsc.rng.setValueAtTime(e,t),this._pulseOsc.rng.setValueAtTime(e,t)}start(e=this._audioContext.currentTime){const t=this._attackDurationParameter.value,a=.2452*this._decayDurationParameter.value,i=this._sustainLevelParameter.value,s=this._adsrGainParameter.getValueAtTime(e);this._adsrGain.gain.cancelAndHoldAtTime(e),this._adsrGain.gain.setValueAtTime(s,e),this._adsrGain.gain.linearRampToValueAtTime(1,e+t),this._adsrGain.gain.setTargetAtTime(i,e+t,a),this._adsrGainParameter.cancelScheduledValues(e),this._adsrGainParameter.setValueAtTime(s,e),this._adsrGainParameter.linearRampToValueAtTime(1,e+t),this._adsrGainParameter.setTargetAtTime(i,e+t,a)}stop(e=this._audioContext.currentTime){const t=.2452*this._releaseDurationParameter.value,a=this._adsrGainParameter.getValueAtTime(e);this._adsrGain.gain.cancelAndHoldAtTime(e),this._adsrGain.gain.setValueAtTime(a,e),this._adsrGain.gain.setTargetAtTime(0,e,t),this._adsrGainParameter.cancelScheduledValues(e),this._adsrGainParameter.setValueAtTime(a,e),this._adsrGainParameter.setTargetAtTime(0,e,t)}connect(e){this._adsrGain.connect(e)}disconnect(){this._adsrGain.disconnect()}reset(e=this._audioContext.currentTime){this._attackDurationParameter.cancelScheduledValues(e),this._attackDurationParameter.setValueAtTime(.002,e),this._decayDurationParameter.cancelScheduledValues(e),this._decayDurationParameter.setValueAtTime(.006,e),this._sustainLevelParameter.cancelScheduledValues(e),this._sustainLevelParameter.setValueAtTime(0,e),this._releaseDurationParameter.cancelScheduledValues(e),this._releaseDurationParameter.setValueAtTime(.006,e),this._adsrGainParameter.cancelScheduledValues(e),this._adsrGainParameter.setValueAtTime(0,e),this._triangleOsc.reset(e),this._sawtoothOsc.reset(e),this._pulseOsc.reset(e),this._noiseOsc.reset(e),this._activeWaveforms.cancelScheduledValues(e),this._activeWaveforms.setValueAtTime([],e),this._adsrGain.gain.cancelScheduledValues(e),this._adsrGain.gain.setValueAtTime(0,e)}}const d=(e,t,a,i,s)=>t+(a-t)/(1+Math.exp(-s*(e-i))),m=e=>d(e,253.7,1786,776.6,.01395),g=e=>d(e,406,6032,979.5,.0108),f=e=>d(e,317.2,2447,838.8,.01555),v=(e,t,a,i,s)=>{if(e<=t)return 0;if(e>=a)return 2047;const n=i-Math.log((a-e)/(e-t))/s;return Math.max(Math.min(n,2047),0)},T=e=>v(e,253.7,1786,776.6,.01395),p=e=>v(e,406,6032,979.5,.0108),V=e=>v(e,317.2,2447,838.8,.01555),y=(e,t,a,i,s,n)=>(t*e**2+a*e+i-n)/s;class b{_audioContext;_inNode;_lowPass;_highPass;_bandPass;_bandPassPeak;_outNode;_in_out;_in_low;_in_band;_in_high;_low_band;_low_high;_band_high;_low_out;_band_out;_high_out;constructor(e){this._audioContext=e,this._inNode=new GainNode(e,{gain:1}),this._lowPass=new BiquadFilterNode(e,{type:"lowpass"}),this._highPass=new BiquadFilterNode(e,{type:"highpass"}),this._bandPass=new BiquadFilterNode(e,{type:"bandpass",Q:1}),this._bandPassPeak=new BiquadFilterNode(e,{type:"peaking",Q:1}),this._outNode=new GainNode(e,{gain:1}),this._in_out=new GainNode(e,{gain:1}),this._in_low=new GainNode(e,{gain:0}),this._in_band=new GainNode(e,{gain:0}),this._in_high=new GainNode(e,{gain:0}),this._low_band=new GainNode(e,{gain:0}),this._low_high=new GainNode(e,{gain:0}),this._band_high=new GainNode(e,{gain:0}),this._low_out=new GainNode(e,{gain:0}),this._band_out=new GainNode(e,{gain:0}),this._high_out=new GainNode(e,{gain:0}),this._inNode.connect(this._in_out),this._in_out.connect(this._outNode),this._inNode.connect(this._in_low),this._in_low.connect(this._lowPass),this._inNode.connect(this._in_band),this._in_band.connect(this._bandPass),this._bandPass.connect(this._bandPassPeak),this._inNode.connect(this._in_high),this._in_high.connect(this._highPass),this._lowPass.connect(this._low_band),this._low_band.connect(this._bandPass),this._lowPass.connect(this._low_high),this._low_high.connect(this._highPass),this._bandPassPeak.connect(this._band_high),this._band_high.connect(this._highPass),this._lowPass.connect(this._low_out),this._low_out.connect(this._outNode),this._bandPassPeak.connect(this._band_out),this._band_out.connect(this._outNode),this._highPass.connect(this._high_out),this._high_out.connect(this._outNode)}get inNode(){return this._inNode}get lowPassFilter(){return this._lowPass}get highPassFilter(){return this._highPass}get bandPassFilter(){return this._bandPass}get bandPassPeakFilter(){return this._bandPassPeak}c64Frequency(e,t=this._audioContext.currentTime){this._highPass.frequency.setValueAtTime(g(e),t),this._lowPass.frequency.setValueAtTime(m(e),t);const a=f(e);this._bandPass.frequency.setValueAtTime(a,t),this._bandPassPeak.frequency.setValueAtTime(a,t)}frequency(e,t=this._audioContext.currentTime){this._highPass.frequency.setValueAtTime(e,t),this._lowPass.frequency.setValueAtTime(e,t),this._bandPass.frequency.setValueAtTime(e,t),this._bandPassPeak.frequency.setValueAtTime(e,t)}c64Resonance(e,t=this._audioContext.currentTime){this._highPass.Q.setValueAtTime((e=>y(e,-.0148,.6794,.1406,.9393,.0526))(e),t),this._lowPass.Q.setValueAtTime((e=>y(e,-.0142,.6892,-.0047,1.0014,-.0762))(e),t),this._bandPassPeak.gain.setValueAtTime((e=>y(e,-.0125,.6889,.0649,1.0167,.2444))(e),t)}resonance(e,t=this._audioContext.currentTime){this._highPass.Q.setValueAtTime(e,t),this._lowPass.Q.setValueAtTime(e,t),this._bandPassPeak.gain.setValueAtTime(e,t)}c64FilterType(e,t=this._audioContext.currentTime){const a=[];1&e&&a.push("lowpass"),2&e&&a.push("bandpass"),4&e&&a.push("highpass"),this.filterType(a,t)}filterType(e,t=this._audioContext.currentTime){e.includes("lowpass")&&e.includes("bandpass")&&e.includes("highpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(1,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(1,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(1,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(1,t)):e.includes("lowpass")&&e.includes("bandpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(1,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(1,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(1,t),this._high_out.gain.setValueAtTime(0,t)):e.includes("lowpass")&&e.includes("highpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(1,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(1,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(1,t)):e.includes("bandpass")&&e.includes("highpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(0,t),this._in_band.gain.setValueAtTime(1,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(1,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(1,t)):e.includes("lowpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(1,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(1,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(0,t)):e.includes("bandpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(0,t),this._in_band.gain.setValueAtTime(1,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(1,t),this._high_out.gain.setValueAtTime(0,t)):e.includes("highpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(0,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(1,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(1,t)):(this._in_out.gain.setValueAtTime(1,t),this._in_low.gain.setValueAtTime(0,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(0,t))}connect(e){this._outNode.connect(e)}disconnect(){this._outNode.disconnect()}reset(e=this._audioContext.currentTime){this._highPass.frequency.cancelScheduledValues(e),this._highPass.frequency.setValueAtTime(0,e),this._highPass.Q.cancelScheduledValues(e),this._highPass.Q.setValueAtTime(1,e),this._lowPass.frequency.cancelScheduledValues(e),this._lowPass.frequency.setValueAtTime(0,e),this._lowPass.Q.cancelScheduledValues(e),this._lowPass.Q.setValueAtTime(1,e),this._bandPass.frequency.cancelScheduledValues(e),this._bandPass.frequency.setValueAtTime(0,e),this._bandPassPeak.frequency.cancelScheduledValues(e),this._bandPassPeak.frequency.setValueAtTime(0,e),this._bandPassPeak.gain.cancelScheduledValues(e),this._bandPassPeak.gain.setValueAtTime(1,e),this._in_out.gain.cancelScheduledValues(e),this._in_out.gain.setValueAtTime(1,e),this._in_low.gain.cancelScheduledValues(e),this._in_low.gain.setValueAtTime(0,e),this._in_band.gain.cancelScheduledValues(e),this._in_band.gain.setValueAtTime(0,e),this._in_high.gain.cancelScheduledValues(e),this._in_high.gain.setValueAtTime(0,e),this._low_band.gain.cancelScheduledValues(e),this._low_band.gain.setValueAtTime(0,e),this._low_high.gain.cancelScheduledValues(e),this._low_high.gain.setValueAtTime(0,e),this._band_high.gain.cancelScheduledValues(e),this._band_high.gain.setValueAtTime(0,e),this._low_out.gain.cancelScheduledValues(e),this._low_out.gain.setValueAtTime(0,e),this._band_out.gain.cancelScheduledValues(e),this._band_out.gain.setValueAtTime(0,e),this._high_out.gain.cancelScheduledValues(e),this._high_out.gain.setValueAtTime(0,e)}}class w{_audioContext;_mainGain;_voice1;_voice2;_voice3;_filter;_v1_gain;_v1_filter;_v1_main;_v2_gain;_v2_filter;_v2_main;_v3_gain;_v3_switch;_v3_filter;_v3_main;constructor(e=new AudioContext){this._audioContext=e,this._mainGain=new GainNode(e,{gain:1}),this._voice1=new _(e,(()=>({frequency:this._voice3.syncFrequency,offset:this._voice3.syncOffset}))),this._voice2=new _(e,(()=>({frequency:this._voice1.syncFrequency,offset:this._voice1.syncOffset}))),this._voice3=new _(e,(()=>({frequency:this._voice2.syncFrequency,offset:this._voice2.syncOffset}))),this._filter=new b(e),this._v1_gain=new GainNode(e,{gain:1/3}),this._v1_filter=new GainNode(e,{gain:0}),this._v1_main=new GainNode(e,{gain:1}),this._v2_gain=new GainNode(e,{gain:1/3}),this._v2_filter=new GainNode(e,{gain:0}),this._v2_main=new GainNode(e,{gain:1}),this._v3_gain=new GainNode(e,{gain:1/3}),this._v3_switch=new GainNode(e,{gain:1}),this._v3_filter=new GainNode(e,{gain:0}),this._v3_main=new GainNode(e,{gain:1}),this._voice1.connect(this._v1_gain),this._v1_gain.connect(this._v1_filter),this._v1_filter.connect(this._filter.inNode),this._v1_gain.connect(this._v1_main),this._v1_main.connect(this._mainGain),this._voice2.connect(this._v2_gain),this._v2_gain.connect(this._v2_filter),this._v2_filter.connect(this._filter.inNode),this._v2_gain.connect(this._v2_main),this._v2_main.connect(this._mainGain),this._voice3.connect(this._v3_switch),this._v3_switch.connect(this._v3_gain),this._v3_gain.connect(this._v3_filter),this._v3_filter.connect(this._filter.inNode),this._v3_gain.connect(this._v3_main),this._v3_main.connect(this._mainGain),this._filter.connect(this._mainGain),this._mainGain.connect(e.destination)}start(){return this._audioContext.resume()}get voice1(){return this._voice1}get voice2(){return this._voice2}get voice3(){return this._voice3}get voices(){return[this._voice1,this._voice2,this._voice3]}get filter(){return this._filter}c64FilterVoice(e,t=this._audioContext.currentTime){this.filterVoice(0,1&e?1:0,t),this.filterVoice(1,2&e?1:0,t),this.filterVoice(2,4&e?1:0,t)}filterVoice(e,t,a=this._audioContext.currentTime){switch(e){case 0:this._v1_filter.gain.setValueAtTime(t,a),this._v1_main.gain.setValueAtTime(1-t,a);break;case 1:this._v2_filter.gain.setValueAtTime(t,a),this._v2_main.gain.setValueAtTime(1-t,a);break;case 2:this._v3_filter.gain.setValueAtTime(t,a),this._v3_main.gain.setValueAtTime(1-t,a)}}c64Voice3Off(e,t=this._audioContext.currentTime){this.voice3Off(Boolean(e),t)}voice3Off(e,t=this._audioContext.currentTime){this._v3_switch.gain.setValueAtTime(e?0:1,t)}c64Volume(e,t=this._audioContext.currentTime){this.volume(e/15,t)}volume(e,t=this._audioContext.currentTime){this._mainGain.gain.setValueAtTime(e,t)}reset(e=this._audioContext.currentTime){this._mainGain.gain.cancelScheduledValues(e),this._mainGain.gain.setValueAtTime(1,e),this._voice1.reset(e),this._voice2.reset(e),this._voice3.reset(e),this._filter.reset(e),this._v1_gain.gain.cancelScheduledValues(e),this._v1_gain.gain.setValueAtTime(1/3,e),this._v1_filter.gain.cancelScheduledValues(e),this._v1_filter.gain.setValueAtTime(0,e),this._v1_main.gain.cancelScheduledValues(e),this._v1_main.gain.setValueAtTime(1,e),this._v2_gain.gain.cancelScheduledValues(e),this._v2_gain.gain.setValueAtTime(1/3,e),this._v2_filter.gain.cancelScheduledValues(e),this._v2_filter.gain.setValueAtTime(0,e),this._v2_main.gain.cancelScheduledValues(e),this._v2_main.gain.setValueAtTime(1,e),this._v3_gain.gain.cancelScheduledValues(e),this._v3_gain.gain.setValueAtTime(1/3,e),this._v3_switch.gain.cancelScheduledValues(e),this._v3_switch.gain.setValueAtTime(1,e),this._v3_filter.gain.cancelScheduledValues(e),this._v3_filter.gain.setValueAtTime(0,e),this._v3_main.gain.cancelScheduledValues(e),this._v3_main.gain.setValueAtTime(1,e)}}},109:(e,t,a)=>{a.a(e,(async(e,i)=>{try{a.d(t,{Q2:()=>m,Qe:()=>f,Rt:()=>g});var s=a(124),n=e([s]);s=(n.then?(await n)():n)[0];const r=[];for(let e=0;e<96;e++)r[e]=document.getElementById(`k${e}`);const l=[];for(let e=0;e<5;e++)l[e]=document.getElementById(`line${e}`);const u=document.getElementById("fileSelect"),o=document.getElementById("openFile"),c=document.getElementById("playPause"),h=document.getElementById("current"),_=document.getElementById("timeslider"),d=document.getElementById("duration"),m=[[],[],[]],g=[-1,-1,-1],f=[-1,-1,-1];let v=0,T=0,p=s.es.currentTime;const V=e=>{const t=Math.floor(e/60),a=Math.floor(e-60*t);return`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`},y=async e=>{c.disabled=!0,_.disabled=!0,T=0,p=s.es.currentTime;const{duration:t,text:a}=await(0,s.ZN)(e);v=t,h.textContent=V(0),d.textContent=V(v),_.max=String(v),_.value=String(T),c.disabled=!1,_.disabled=!1;for(let e=0;e<a.length;e++)l[e].textContent=a[e];for(let e=a.length;e<5;e++)l[e].textContent=""};o.onchange=e=>{q(),P=!1,c.classList.remove("paused");const t=e.target.files[0];t&&y(t)},u.onchange=async e=>{q(),P=!1,c.classList.remove("paused");const t=e.target.value;if(t){const e=await fetch(`sids/${t}.MUS.prg`),a=await e.blob();y(a)}else{c.disabled=!0,_.disabled=!0,T=0,p=s.es.currentTime,v=0,h.textContent="",d.textContent="",_.max=String(1),_.value=String(0);for(let e=0;e<5;e++)l[e].textContent=""}};const b=e=>{const t=[0,2,4,5,7,9,11].includes(e%12)?"linear-gradient(to bottom, #fff, #e0e0e0)":"linear-gradient(to bottom, #222, #000)";r[e].style.background=t},w={0:"#EEEE77",1:"#664400",2:"#CC44CC"},A=(e,t)=>{r[e].style.background=w[t]};let P=!1;const k=()=>{P?(O(),P=!1,c.classList.remove("paused")):(x(),P=!0,c.classList.add("paused"))},x=()=>{C||(C=setInterval(S,100)),s.es.resume()},O=()=>{C&&(clearInterval(C),C=void 0),s.es.suspend()},q=()=>{O();for(let e=0;e<3;e++)f[e]>=0&&(b(m[e][f[e]].index),f[e]=-1)};let C;c.onclick=k,_.oninput=e=>{q(),h.textContent=V(e.target.value)},_.onmouseup=e=>{c.disabled=!0,_.disabled=!0,T=Number(e.target.value),p=s.es.currentTime,(0,s.F9)(T),P&&x(),c.disabled=!1,_.disabled=!1};const S=()=>{const e=s.es.currentTime;for(let t=0;t<3;t++)if(0!==m[t].length&&(f[t]>=0&&e>m[t][f[t]].stop&&(b(m[t][f[t]].index),f[t]=-1),g[t]<m[t].length-1&&e>=m[t][g[t]+1].start)){for(;g[t]<m[t].length-1&&m[t][g[t]+1].start<=e;)g[t]++;A(m[t][g[t]].index,t),f[t]=g[t]}_.value=String(e-p+T),h.textContent=V(Math.min(e-p+T,v)),e-p+T>v&&(q(),P=!1,c.classList.remove("paused"))};i()}catch(e){i(e)}}))},124:(e,t,a)=>{a.a(e,(async(e,i)=>{try{a.d(t,{F9:()=>y,ZN:()=>V,es:()=>u});var s=a(27),n=a(329),r=a(109),l=e([r]);r=(l.then?(await l)():l)[0];const u=new AudioContext;await u.suspend();try{if("function"!=typeof u.createGain().gain.cancelAndHoldAtTime)throw new Error("Unsupported browser: cancelAndHoldAtTime not available.")}catch(e){throw console.error("Error during feature detection:",e),document.getElementById("main-content").style.display="none",document.getElementById("unsupported-message").style.display="block",e}const o=new s.hz(u),c=(e,t,a,i,n)=>{if("rst"===e)return{index:-1,frequency:0};let r={c:0,d:2,e:4,f:5,g:7,a:9,b:11,rst:NaN}[e];switch(t){case"flt":r--;break;case"nat":default:break;case"shp":r++;break;case"dbl":["g","f","d","c"].includes(e)?r+=2:["a","b","e"].includes(e)&&(r-=2)}return r+=12*a,r+=n,{index:r,frequency:440*2**((r-57)/12)+i*s.pu}},h=(e,t,a,i)=>{let s;switch(e){case"whl":s=4;break;case"hlf":s=2;break;case"qtr":default:s=1;break;case"8th":s=.5;break;case"16th":s=1/4;break;case"32nd":s=1/8;break;case"64th":s=1/16;break;case"utl":return i/60}switch(t){case"non":default:break;case"sgl":s*=1.5;break;case"dbl":s*=1.75}return 60/a*s},_=(e,t,a,i,n,r)=>{if(0===n.rate&&0===r.depth)e.frequency(a,t);else if(0!==n.rate){const l=Math.sign(a-n.startFrequency)*n.rate*60*s.pu;if(Math.abs(a-n.startFrequency)>=Math.abs(l*i)){const a=n.startFrequency+l*i;e.frequency(n.startFrequency,t),e.triangleOscillator.frequency.linearRampToValueAtTime(a,t+i),e.sawtoothOscillator.frequency.linearRampToValueAtTime(a,t+i),e.pulseOscillator.frequency.linearRampToValueAtTime(a,t+i),e.noiseOscillator.frequency.linearRampToValueAtTime(a,t+i)}else{const s=(a-n.startFrequency)/l;e.frequency(n.startFrequency,t),e.triangleOscillator.frequency.linearRampToValueAtTime(a,t+s),e.sawtoothOscillator.frequency.linearRampToValueAtTime(a,t+s),e.pulseOscillator.frequency.linearRampToValueAtTime(a,t+s),e.noiseOscillator.frequency.linearRampToValueAtTime(a,t+s),0!==r.depth&&_(e,t+s,a,i-s,{...n,rate:0},r)}}else{const n=60*r.depth*s.pu,l=a+r.depth*s.pu*r.rate;let u=0,o=!0;e.frequency(a,t);do{u+r.rate/60<i?(u+=r.rate/60,o?(e.triangleOscillator.frequency.linearRampToValueAtTime(l,t+u),e.sawtoothOscillator.frequency.linearRampToValueAtTime(l,t+u),e.pulseOscillator.frequency.linearRampToValueAtTime(l,t+u),e.noiseOscillator.frequency.linearRampToValueAtTime(l,t+u),e.frequency(l,t+u)):(e.triangleOscillator.frequency.linearRampToValueAtTime(a,t+u),e.sawtoothOscillator.frequency.linearRampToValueAtTime(a,t+u),e.pulseOscillator.frequency.linearRampToValueAtTime(a,t+u),e.noiseOscillator.frequency.linearRampToValueAtTime(a,t+u),e.frequency(a,t+u))):(o?(e.triangleOscillator.frequency.linearRampToValueAtTime(a+n*(i-u),t+i),e.sawtoothOscillator.frequency.linearRampToValueAtTime(a+n*(i-u),t+i),e.pulseOscillator.frequency.linearRampToValueAtTime(a+n*(i-u),t+i),e.noiseOscillator.frequency.linearRampToValueAtTime(a+n*(i-u),t+i),e.frequency(a+n*(i-u),t+u)):(e.triangleOscillator.frequency.linearRampToValueAtTime(l-n*(i-u),t+i),e.sawtoothOscillator.frequency.linearRampToValueAtTime(l-n*(i-u),t+i),e.pulseOscillator.frequency.linearRampToValueAtTime(l-n*(i-u),t+i),e.noiseOscillator.frequency.linearRampToValueAtTime(l-n*(i-u),t+i),e.frequency(l-n*(i-u),t+u)),u=i),o=!o}while(u<i)}},d=(e,t,a,i,s)=>{const n=60*i;let r=0,l=a;e.pulseOscillator.width.setValueAtTime(a/4095,t);do{n>0&&r+(4095-l)/n<s?(r+=(4095-l)/n,l=0,e.pulseOscillator.width.linearRampToValueAtTime(1,t+r),e.pulseOscillator.width.setValueAtTime(0,t+r)):n<0&&r-l/n<s?(r-=l/n,l=4095,e.pulseOscillator.width.linearRampToValueAtTime(0,t+r),e.pulseOscillator.width.setValueAtTime(1,t+r)):(e.pulseOscillator.width.linearRampToValueAtTime((l+n*(s-r))/4095,t+s),r=s)}while(r<s);e.pulseOscillator.width.setValueAtTime(a/4095,t+s)},m=(e,t,a,i)=>{const s=e+t*a,n=Math.max(Math.floor(60*a),2),r=(s-e)/(n-1),l=[];let u=e;for(let e=0;e<n;e++)l.push(i(u)),u+=r;return l},g=(e,t,a,i)=>{const n=60*a;let r=0,l=t;o.filter.c64Frequency(t,e);do{if(n>0&&r+(2047-l)/n<i){const t=(2047-l)/n;o.filter.lowPassFilter.frequency.setValueCurveAtTime(m(l,n,t,s.Ax),e+r,t),o.filter.highPassFilter.frequency.setValueCurveAtTime(m(l,n,t,s.Wi),e+r,t);const a=m(l,n,t,s.br);o.filter.bandPassFilter.frequency.setValueCurveAtTime(a,e+r,t),o.filter.bandPassPeakFilter.frequency.setValueCurveAtTime(a,e+r,t),r+=t,l=0}else if(n<0&&r-l/n<i){const t=-l/n;o.filter.lowPassFilter.frequency.setValueCurveAtTime(m(l,n,t,s.Ax),e+r,t),o.filter.highPassFilter.frequency.setValueCurveAtTime(m(l,n,t,s.Wi),e+r,t);const a=m(l,n,t,s.br);o.filter.bandPassFilter.frequency.setValueCurveAtTime(a,e+r,t),o.filter.bandPassPeakFilter.frequency.setValueCurveAtTime(a,e+r,t),r+=t,l=2047}else{const t=i-r-1e-6;o.filter.lowPassFilter.frequency.setValueCurveAtTime(m(l,n,t,s.Ax),e+r,t),o.filter.highPassFilter.frequency.setValueCurveAtTime(m(l,n,t,s.Wi),e+r,t);const a=m(l,n,t,s.br);o.filter.bandPassFilter.frequency.setValueCurveAtTime(a,e+r,t),o.filter.bandPassPeakFilter.frequency.setValueCurveAtTime(a,e+r,t),r=i}}while(r<i);o.filter.c64Frequency(t,e+i)},f=(e,t,a,i)=>{const n=2*t;let r=i.includes("lowpass")?(0,s.Lo)(n):i.includes("highpass")?(0,s.Rl)(n):(0,s.Qq)(n);return r=Math.max(Math.min(r+a,2047),0),o.filter.c64Frequency(r,e),r},v=e=>{for(let t=0;t<e.length;t++)r.Q2[t]=[],r.Rt[t]=-1,r.Qe[t]=-1,e[t].c64Waveform(4),e[t].c64AttackDuration(2),e[t].c64DecayDuration(0),e[t].c64SustainLevel(15),e[t].c64ReleaseDuration(5),e[t].c64PulseWidth(2048);o.c64Volume(8)},T=(e,t,a)=>{v(e);const i=u.currentTime;let s=i,n=100,l=8,m=12;const T=[];for(let t=0;t<e.length;t++)T.push({cmdPointer:{voice:t,index:0},callStack:[],hed:{pointer:{voice:t,index:0},count:1},time:i,releasePoint:4,detune:0,transpose:0,tie:!1,portamentoRate:0,portamentoStartFrequency:0,pulseWidth:2048,pulseWidthSweepRate:0,vibratoRate:0,vibratoDepth:0,filter:[],filterFrequency:0,filterFrequencySweepRate:0,autoFilter:0,halt:!1});let p=0;const V=[];for(let e=0;e<t.length;e++)for(let a=0;a<t[e].length;a++){const i=t[e][a];"def"===i.type&&V.push({index:i.data.value,pointer:{voice:e,index:a}})}do{let{cmdPointer:u,callStack:v,hed:y,time:b,releasePoint:w,detune:A,transpose:P,tie:k,portamentoRate:x,portamentoStartFrequency:O,pulseWidth:q,pulseWidthSweepRate:C,vibratoRate:S,vibratoDepth:G,filter:N,filterFrequency:R,filterFrequencySweepRate:F,autoFilter:M,halt:D}=T[p];for(;!D&&u.index<t[u.voice].length&&b<=s;){const s=t[u.voice][u.index];switch(s.type){case"tem":n=s.data.value;break;case"utl":m=s.data.value;break;case"vol":l=s.data.value,o.c64Volume(l,Math.max(b-a,i));break;case"bmp":"up"===s.data.value&&l<15&&l++,"down"===s.data.value&&l>0&&l--,o.c64Volume(l,Math.max(b-a,i));break;case"hed":y={pointer:{...u},count:s.data.value-1};break;case"tal":y.count>0&&(u={...y.pointer},y.count--);break;case"cal":const t=V.find((e=>e.index===s.data.value));if(!t)throw new Error(`UNDEFINED PHRASE CALL: ${JSON.stringify(u)}, ${JSON.stringify(s)}`);if(v.push({pointer:{...u},cmd:"cal"}),v.length>255)throw new Error(`STACK OVERFLOW: ${JSON.stringify(u)}, ${JSON.stringify(s)}`);u={...t.pointer};break;case"def":if(v.push({pointer:{...u},cmd:"def"}),v.length>255)throw new Error(`STACK OVERFLOW: ${JSON.stringify(u)}, ${JSON.stringify(s)}`);break;case"end":if(0===v.length)throw new Error(`STACK UNDERFLOW: ${JSON.stringify(u)}, ${JSON.stringify(s)}`);const T=v.pop();"cal"===T.cmd&&(u={...T.pointer});break;case"f-m":N=s.data.value.slice(),o.filter.filterType(s.data.value,Math.max(b-a,i));break;case"aut":M=s.data.value;break;case"res":o.filter.c64Resonance(s.data.value,Math.max(b-a,i));break;case"flt":o.filterVoice(p,"yes"===s.data.value?1:0,Math.max(b-a,i));break;case"f-s":F=s.data.value;break;case"f-c":R=8*s.data.value,o.filter.c64Frequency(R,Math.max(b-a,i));break;case"f-x":case"ms#":case"flg":case"aux":break;case"atk":e[p].c64AttackDuration(s.data.value,Math.max(b-a,i));break;case"dcy":e[p].c64DecayDuration(s.data.value,Math.max(b-a,i));break;case"sus":e[p].c64SustainLevel(s.data.value,Math.max(b-a,i));break;case"rls":e[p].c64ReleaseDuration(s.data.value,Math.max(b-a,i));break;case"pnt":w=s.data.value;break;case"wav":e[p].waveform(s.data.value,Math.max(b-a,i));break;case"p-w":q=s.data.value,e[p].c64PulseWidth(q,Math.max(b-a,i));break;case"p-s":C=s.data.value;break;case"snc":e[p].sync("yes"===s.data.value,Math.max(b-a,i));break;case"rng":e[p].rng("yes"===s.data.value,Math.max(b-a,i));break;case"vdp":G=s.data.value;break;case"vrt":S=s.data.value;break;case"por":x=s.data.value;break;case"dtn":A=s.data.value;break;case"tps":P=s.data.value;break;case"3-O":o.voice3Off("yes"===s.data.value,Math.max(b-a,i));break;case"hlt":D=!0;break;case"note":const{index:E,frequency:W}=c(s.data.note,s.data.modifier,s.data.octave,A,P),L=h(s.data.duration,s.data.dotted,n,m);b>=i+a&&0!==W&&(_(e[p],b-a,W,L,{startFrequency:O,rate:x},{depth:G,rate:S}),0!==C&&d(e[p],b-a,q,C,L),0!==M&&(R=f(b-a,W,M,N)),0!==F&&g(b-a,R,F,L),k||e[p].start(b-a),k=s.data.tie,k||e[p].stop(b-a+Math.max(L-w/60,0)),E>=0&&E<=95&&r.Q2[p].push({start:b-a,stop:b-a+Math.max(L-Math.max(w-2,0)/60,0),index:E})),b+=L,O=W;break;case"abs":const{frequency:$}=c(s.data.note,s.data.modifier,s.data.octave,A,P);O=$;break;default:console.error(`${s.type} not implemented`)}u.index++}T[p]={cmdPointer:u,callStack:v,hed:y,time:b,releasePoint:w,detune:A,transpose:P,tie:k,portamentoRate:x,portamentoStartFrequency:O,pulseWidth:q,pulseWidthSweepRate:C,vibratoRate:S,vibratoDepth:G,filter:N,filterFrequency:R,filterFrequencySweepRate:F,autoFilter:M,halt:D},b>s&&(s=b),p++,p>=e.length&&(p=0)}while(T.some((e=>!e.halt&&e.cmdPointer.index<t[e.cmdPointer.voice].length)));return Math.floor(10*Math.max(...T.map((e=>e.time-i))))/10};let p;const V=async e=>{const t=await(0,n.g)(e);return p=t.voices,{duration:y(0),text:t.text}},y=e=>(o.reset(0),T(o.voices,p,e));i()}catch(e){i(e)}}),1)},329:(e,t,a)=>{a.d(t,{g:()=>n});const i=(e,t)=>{if(!(3&e)){let a,i;switch(31&e){case 0:a="64th";break;case 28:a="32nd";break;case 24:a="16th";break;case 20:a="8th";break;case 16:a="qtr";break;case 12:a="hlf";break;default:a="whl"}switch(163&e){case 32:i="sgl";break;case 160:i="dbl";break;default:i="non"}const s=64==(67&e);let n,r,l;switch(4==(63&e)&&(a="utl"),36==(63&e)&&(a="utv"),128==(163&e)&&console.warn("triplet not implemented"),160==(191&e)&&console.warn("triplet 64th note not implemented"),192&t){case 192:n="flt";break;case 128:default:n="nat";break;case 64:n="shp";break;case 0:n="dbl"}switch(56&t){case 56:r=0;break;case 48:r=1;break;case 40:r=2;break;case 32:r=3;break;case 24:default:r=4;break;case 16:r=5;break;case 8:r=6;break;case 0:r=7}switch(7&t){case 7:l="b";break;case 6:l="a";break;case 5:l="g";break;case 4:l="f";break;case 3:l="e";break;case 2:l="d";break;case 1:default:l="c";break;case 0:l="rst"}return{type:0===e?"abs":"note",data:{duration:a,dotted:i,tie:s,modifier:n,octave:r,note:l}}}if(1===e){if(!(15&t))return{type:"dcy",data:{value:(240&t)>>>4}};if(1==(7&t))return{type:"rup",data:{value:(248&t)>>>3}};if(2==(15&t))return{type:"cal",data:{value:(240&t)>>>4}};if(3===t)return{type:"bmp",data:{value:"up"}};if(19===t)return{type:"flt",data:{value:"no"}};if(35===t)return{type:"rng",data:{value:"no"}};if(51===t)return{type:"snc",data:{value:"no"}};if(67===t)return{type:"f-x",data:{value:"no"}};if(83===t)return{type:"3-O",data:{value:"no"}};if(131==(143&t))return{type:"def",data:{value:8+((240&t)>>>4)}};if(4==(135&t))return{type:"atk",data:{value:(120&t)>>>3}};if(132==(135&t))return{type:"sus",data:{value:(120&t)>>>3}};if(99===t)return{type:"lfo",data:{value:0}};if(115===t)return{type:"p&v",data:{value:"no"}};if(5==(7&t))return{type:"rdn",data:{value:(248&t)>>>3}};if(6==(15&t))return{type:"def",data:{value:(240&t)>>>4}};if(7==(31&t)){let e;switch(224&t){case 0:e=["noise"];break;case 32:default:e=["triangle"];break;case 64:e=["sawtooth"];break;case 96:e=["triangle","sawtooth"];break;case 128:e=["pulse"];break;case 160:e=["pulse","triangle"];break;case 192:e=["pulse","sawtooth"];break;case 224:e=["pulse","triangle","sawtooth"]}return{type:"wav",data:{value:e}}}if(23==(31&t)){let e;switch(224&t){case 0:default:e=[];break;case 32:e=["lowpass"];break;case 64:e=["bandpass"];break;case 96:e=["lowpass","bandpass"];break;case 128:e=["highpass"];break;case 160:e=["highpass","lowpass"];break;case 192:e=["highpass","bandpass"];break;case 224:e=["highpass","lowpass","bandpass"]}return{type:"f-m",data:{value:e}}}if(8==(15&t))return{type:"rls",data:{value:(240&t)>>>4}};if(10==(15&t))return{type:"res",data:{value:(240&t)>>>4}};if(11===t)return{type:"bmp",data:{value:"down"}};if(27===t)return{type:"flt",data:{value:"yes"}};if(43===t)return{type:"rng",data:{value:"yes"}};if(59===t)return{type:"snc",data:{value:"yes"}};if(75===t)return{type:"f-x",data:{value:"yes"}};if(91===t)return{type:"3-O",data:{value:"yes"}};if(107===t)return{type:"lfo",data:{value:1}};if(123===t)return{type:"p&v",data:{value:"yes"}};if(139==(143&t))return{type:"cal",data:{value:8+((240&t)>>>4)}};if(14==(15&t))return{type:"vol",data:{value:(240&t)>>>4}};if(15===t)return{type:"tal"};if(47===t)return{type:"end"};if(79===t)return{type:"hlt"};if(31==(159&t))return{type:"src",data:{value:(96&t)>>>5}};if(!(143&~t)){let e;switch(112&t){case 0:default:e=0;break;case 32:e=1;break;case 80:e=2;break;case 96:e=3}return{type:"dst",data:{value:e}}}}else{if(2==(15&e))return{type:"p-w",data:{value:((240&e)<<4)+t}};if(6===e)return{type:"tem",data:{value:Math.trunc(14400/(0!==t?t:256))}};if(22===e)return{type:"utl",data:{value:0!==t?t:256}};if(38===e)return{type:"pnt",data:{value:t}};if(54===e)return{type:"hed",data:{value:t}};if(70===e)return{type:"flg",data:{value:t}};if(86===e)return{type:"p-s",data:{value:t<<24>>24}};if(102===e)return{type:"f-s",data:{value:t<<24>>24}};if(110===e)return{type:"sca",data:{value:t<<24>>24}};if(118===e)return{type:"vdp",data:{value:t}};if(134===e)return{type:"vrt",data:{value:0!==t?t:256}};if(150===e)return{type:"aut",data:{value:t<<24>>24}};if(166===e)return{type:"tps",data:{value:(1&t?-1:1)*(12*(1&t?(14&t)>>>1:7-((14&t)>>>1))+(1&t?11-((240&t)>>>4):(240&t)>>>4))}};if(182===e)return{type:"aux",data:{value:t}};if(198===e)return{type:"pvd",data:{value:t}};if(214===e)return{type:"pvr",data:{value:t}};if(230===e)return{type:"max",data:{value:t}};if(246===e)return{type:"utv",data:{value:t}};if(14===e)return{type:"f-c",data:{value:t}};if(46===e)return{type:"rtp",data:{octaves:3-(7&t),halfsteps:((248&t)>>>3)-11}};if(78===e)return{type:"hld",data:{value:t}};if(30===e||94===e||158===e||222===e)return{type:"ms#",data:{value:((192&e)<<2)+t}};if(62===e||126===e||190===e||254===e){let a=(t<<2)+((192&e)>>>6);return t>192&&(a=a<<22>>22),{type:"jif",data:{value:a}}}if(10==(15&e))return{type:"dtn",data:{value:16&e?((224&e)<<3)+t-2048:((224&e)<<3)+t}};if(!(3&~e))return{type:"por",data:{value:((252&e)<<6)+t}}}},s={3:"stop",5:"wht",8:"shOff",9:"shOn",13:"\n",14:"lCase",17:"down",18:"rvsOn",19:"home",20:"del",28:"red",29:"right",30:"grn",31:"blu",32:" ",33:"!",34:'"',35:"#",36:"$",37:"%",38:"&",39:"'",40:"(",41:")",42:"*",43:"+",44:",",45:"-",46:".",47:"/",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",58:":",59:";",60:"<",61:"=",62:">",63:"?",64:"@",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"[",92:"£",93:"]",94:"↑",95:"←",96:"─",97:"♠",98:"│",99:"─",100:"🭷",101:"🭶",102:"🭺",103:"🭱",104:"🭴",105:"╮",106:"╰",107:"╯",108:"🭼",109:"╲",110:"╱",111:"🭽",112:"🭾",113:"•",114:"🭻",115:"♥",116:"🭰",117:"╭",118:"╳",119:"○",120:"♣",121:"🭵",122:"♦",123:"┼",124:"🮌",125:"│",126:"π",127:"◥",129:"orng",131:"run",133:"f1",134:"f3",135:"f5",136:"f7",137:"f2",138:"f4",139:"f6",140:"f8",141:"shRtrn",142:"uCase",144:"blk",145:"up",146:"rvsOff",147:"clr",148:"inst",149:"brn",150:"lred",151:"dgry",152:"mgry",153:"lgrn",154:"lblu",155:"lgry",156:"pur",157:"left",158:"yel",159:"cyn",160:" ",161:"▌",162:"▄",163:"▔",164:"▁",165:"▎",166:"▒",167:"🮇",168:"🮏",169:"◤",170:"🮇",171:"├",172:"▗",173:"└",174:"┐",175:"▂",176:"┌",177:"┴",178:"┬",179:"┤",180:"▎",181:"▍",182:"🮈",183:"🮂",184:"🮃",185:"▃",186:"🭿",187:"▖",188:"▝",189:"┘",190:"▘",191:"▚",192:"─",193:"♠",194:"│",195:"─",196:"🭷",197:"🭶",198:"🭺",199:"🭱",200:"🭴",201:"╮",202:"╰",203:"╯",204:"🭼",205:"╲",206:"╱",207:"🭽",208:"🭾",209:"•",210:"🭻",211:"♥",212:"🭰",213:"╭",214:"╳",215:"○",216:"♣",217:"🭵",218:"♦",219:"┼",220:"🮌",221:"│",222:"π",223:"◥",224:" ",225:"▌",226:"▄",227:"▔",228:"▁",229:"▎",230:"▒",231:"🮇",232:"🮏",233:"◤",234:"🮇",235:"├",236:"▗",237:"└",238:"┐",239:"▂",240:"┌",241:"┴",242:"┬",243:"┤",244:"▎",245:"▍",246:"🮈",247:"🮂",248:"🮃",249:"▃",250:"🭿",251:"▖",252:"▝",253:"┘",254:"▘",255:"π"},n=async e=>{const t=new DataView(await(async e=>new Promise(((t,a)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=a,i.readAsArrayBuffer(e)})))(e));let a=0;t.getUint16(a,!0),a+=2;const n=t.getUint16(a,!0);a+=2;const r=t.getUint16(a,!0);a+=2;const l=t.getUint16(a,!0);a+=2;const u=8+n,o=u+r,c=o+l,h=[];for(let e=8;e<u;e+=2){const a=t.getUint8(e),s=t.getUint8(e+1),n=i(a,s);if(!n){console.error(`unknown command, voiceindex 0, index ${h.length}, byte1 ${a}, byte2 ${s}`);break}h.push(n)}const _=[];for(let e=u;e<o;e+=2){const a=t.getUint8(e),s=t.getUint8(e+1),n=i(a,s);if(!n){console.error(`unknown command, voiceindex 1, index ${_.length}, byte1 ${a}, byte2 ${s}`);break}_.push(n)}const d=[];for(let e=o;e<c;e+=2){const a=t.getUint8(e),s=t.getUint8(e+1),n=i(a,s);if(!n){console.error(`unknown command, voiceindex 2, index ${d.length}, byte1 ${a}, byte2 ${s}`);break}d.push(n)}const m=[];let g="";for(let e=c;e<t.byteLength;e++){const a=t.getUint8(e);if(13===a)m.push(g),g="";else{if(0===a){g&&m.push(g);break}g+=s[a]||"?"}}return{voices:[h,_,d],text:m}}}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return s[e](a,a.exports,r),a.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",a="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},r.a=(s,n,r)=>{var l;r&&((l=[]).d=-1);var u,o,c,h=new Set,_=s.exports,d=new Promise(((e,t)=>{c=t,o=e}));d[t]=_,d[e]=e=>(l&&e(l),h.forEach(e),d.catch((e=>{}))),s.exports=d,n((s=>{var n;u=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[e])return s;if(s.then){var n=[];n.d=0,s.then((e=>{r[t]=e,i(n)}),(e=>{r[a]=e,i(n)}));var r={};return r[e]=e=>e(n),r}}var l={};return l[e]=e=>{},l[t]=s,l})))(s);var r=()=>u.map((e=>{if(e[a])throw e[a];return e[t]})),o=new Promise((t=>{(n=()=>t(r)).r=0;var a=e=>e!==l&&!h.has(e)&&(h.add(e),e&&!e.d&&(n.r++,e.push(n)));u.map((t=>t[e](a)))}));return n.r?o:r()}),(e=>(e?c(d[a]=e):o(_),i(l)))),l&&l.d<0&&(l.d=0)},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(109)})();
//# sourceMappingURL=sidplayer.bundle.js.map