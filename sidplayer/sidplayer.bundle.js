(()=>{"use strict";var e,t,a,i,s={27:(e,t,a)=>{a.d(t,{Ax:()=>u,Lo:()=>d,Qq:()=>m,Rl:()=>_,Wi:()=>o,br:()=>c,hz:()=>v,pu:()=>i});const i=.0587253835466173;class s{_audioContext;_values=[];_defaultValue;constructor(e,t){this._audioContext=e,this._values.push({startTime:e.currentTime,value:t,interpolation:"const"}),this._defaultValue=t}setValueAtTime(e,t){if(t<this._values[0].startTime)this._values.unshift({startTime:t,value:e,interpolation:"const"});else if(t>=this._values[this._values.length-1].startTime)this._values.push({startTime:t,value:e,interpolation:"const"});else for(let a=0;a<this._values.length-1;a++)if(t>=this._values[a].startTime&&t<this._values[a+1].startTime){this._values.splice(a+1,0,{startTime:t,value:e,interpolation:"const"});break}return this}getValueAtTime(e){if(e<this._values[0].startTime)return this._defaultValue;let t;if(1===this._values.length)t=this._values[0];else{for(let a=0;a<this._values.length-1;a++)if(e>=this._values[a].startTime&&e<this._values[a+1].startTime){t=this._values[a];break}t||(t=this._values[this._values.length-1])}return"const"===t.interpolation?t.value:"lin"===t.interpolation?e<t.endTime?t.startValue+(e-t.startTime)/(t.endTime-t.startTime)*(t.endValue-t.startValue):t.endValue:t.endValue+(t.startValue-t.endValue)*Math.exp(-(e-t.startTime)/t.timeConstant)}get value(){return this.getValueAtTime(this._audioContext.currentTime)}set value(e){this.setValueAtTime(e,this._audioContext.currentTime)}cancelScheduledValues(e){const t=this._values.findIndex((t=>e<t.startTime));t>=0&&this._values.splice(t),0===this._values.length&&this._values.push({startTime:this._audioContext.currentTime,value:this._defaultValue,interpolation:"const"})}linearRampToValueAtTime(e,t){if(t<this._values[0].startTime);else if(t>=this._values[this._values.length-1].startTime){const a=this._values.pop();this._values.push({startTime:a.startTime,startValue:"const"===a.interpolation?a.value:a.startValue,endTime:t,endValue:e,interpolation:"lin"})}else for(let a=0;a<this._values.length-1;a++)if(t>=this._values[a].startTime&&t<this._values[a+1].startTime){const i=this._values.splice(a,1)[0];this._values.splice(a,0,{startTime:i.startTime,startValue:"const"===i.interpolation?i.value:i.startValue,endTime:t,endValue:e,interpolation:"lin"});break}return this}setTargetAtTime(e,t,a){if(t<this._values[0].startTime)this._values.unshift({startTime:t,startValue:this._defaultValue,endValue:e,timeConstant:a,interpolation:"exp"});else if(t>=this._values[this._values.length-1].startTime)this._values.push({startTime:t,startValue:this.getValueAtTime(t),endValue:e,timeConstant:a,interpolation:"exp"});else for(let i=0;i<this._values.length-1;i++)if(t>=this._values[i].startTime&&t<this._values[i+1].startTime){this._values.splice(i+1,0,{startTime:t,startValue:this.getValueAtTime(t),endValue:e,timeConstant:a,interpolation:"exp"});break}return this}}class n{_audioContext;_oscillator;constructor(e){this._audioContext=e,this._oscillator=new AudioWorkletNode(e,"C64SidProcessor",{numberOfInputs:1,numberOfOutputs:3,outputChannelCount:[1,1,1],processorOptions:{sampleRate:e.sampleRate}})}get voice1Params(){return{waveform:this._oscillator.parameters.get("voice1Waveform"),frequency:this._oscillator.parameters.get("voice1Frequency"),width:this._oscillator.parameters.get("voice1Width"),sync:this._oscillator.parameters.get("voice1Sync"),rng:this._oscillator.parameters.get("voice1Rng")}}get voice2Params(){return{waveform:this._oscillator.parameters.get("voice2Waveform"),frequency:this._oscillator.parameters.get("voice2Frequency"),width:this._oscillator.parameters.get("voice2Width"),sync:this._oscillator.parameters.get("voice2Sync"),rng:this._oscillator.parameters.get("voice2Rng")}}get voice3Params(){return{waveform:this._oscillator.parameters.get("voice3Waveform"),frequency:this._oscillator.parameters.get("voice3Frequency"),width:this._oscillator.parameters.get("voice3Width"),sync:this._oscillator.parameters.get("voice3Sync"),rng:this._oscillator.parameters.get("voice3Rng")}}connect(e,t,a){this._oscillator.connect(e,t,a)}disconnect(){this._oscillator.disconnect()}}class r{_audioContext;_adsrGain;_waveformParameter;_frequencyParameter;_widthParameter;_syncParameter;_rngParameter;_attackDurationParameter;_decayDurationParameter;_sustainLevelParameter;_releaseDurationParameter;_adsrGainParameter;constructor(e,t){this._audioContext=e,this._adsrGain=new GainNode(e,{gain:0}),this._waveformParameter=t.waveform,this._frequencyParameter=t.frequency,this._widthParameter=t.width,this._syncParameter=t.sync,this._rngParameter=t.rng,this._attackDurationParameter=new s(e,.002),this._decayDurationParameter=new s(e,.006),this._sustainLevelParameter=new s(e,0),this._releaseDurationParameter=new s(e,.006),this._adsrGainParameter=new s(e,0)}get inNode(){return this._adsrGain}get frequencyParam(){return this._frequencyParameter}get widthParam(){return this._widthParameter}c64Frequency(e,t=this._audioContext.currentTime){this.frequency(e*i,t)}frequency(e,t=this._audioContext.currentTime){this._frequencyParameter.setValueAtTime(e,t)}c64Waveform(e,t=this._audioContext.currentTime){this._waveformParameter.setValueAtTime(e,t)}waveform(e,t=this._audioContext.currentTime){const a=(e.includes("triangle")?1:0)+(e.includes("sawtooth")?2:0)+(e.includes("pulse")?4:0)+(e.includes("noise")?8:0);this.c64Waveform(a,t)}static timeTable=[.002,.008,.016,.024,.038,.056,.068,.08,.1,.25,.5,.8,1,3,5,8];c64AttackDuration(e,t=this._audioContext.currentTime){this.attackDuration(r.timeTable[e],t)}attackDuration(e,t=this._audioContext.currentTime){this._attackDurationParameter.setValueAtTime(e,t)}c64DecayDuration(e,t=this._audioContext.currentTime){this.decayDuration(3*r.timeTable[e],t)}decayDuration(e,t=this._audioContext.currentTime){this._decayDurationParameter.setValueAtTime(e,t)}c64SustainLevel(e,t=this._audioContext.currentTime){this.sustainLevel(e/15,t)}sustainLevel(e,t=this._audioContext.currentTime){this._sustainLevelParameter.setValueAtTime(e,t)}c64ReleaseDuration(e,t=this._audioContext.currentTime){this.releaseDuration(3*r.timeTable[e],t)}releaseDuration(e,t=this._audioContext.currentTime){this._releaseDurationParameter.setValueAtTime(e,t)}c64PulseWidth(e,t=this._audioContext.currentTime){this.pulseWidth(e/4095,t)}pulseWidth(e,t=this._audioContext.currentTime){this._widthParameter.setValueAtTime(e,t)}c64Sync(e,t=this._audioContext.currentTime){this._syncParameter.setValueAtTime(e,t)}sync(e,t=this._audioContext.currentTime){this.c64Sync(Number(e),t)}c64Rng(e,t=this._audioContext.currentTime){this._rngParameter.setValueAtTime(e,t)}rng(e,t=this._audioContext.currentTime){this.c64Rng(Number(e),t)}start(e=this._audioContext.currentTime){const t=this._attackDurationParameter.value,a=.2452*this._decayDurationParameter.value,i=this._sustainLevelParameter.value,s=this._adsrGainParameter.getValueAtTime(e);this._adsrGain.gain.cancelAndHoldAtTime(e),this._adsrGain.gain.setValueAtTime(s,e),this._adsrGain.gain.linearRampToValueAtTime(1,e+t),this._adsrGain.gain.setTargetAtTime(i,e+t,a),this._adsrGainParameter.cancelScheduledValues(e),this._adsrGainParameter.setValueAtTime(s,e),this._adsrGainParameter.linearRampToValueAtTime(1,e+t),this._adsrGainParameter.setTargetAtTime(i,e+t,a)}stop(e=this._audioContext.currentTime){const t=.2452*this._releaseDurationParameter.value,a=this._adsrGainParameter.getValueAtTime(e);this._adsrGain.gain.cancelAndHoldAtTime(e),this._adsrGain.gain.setValueAtTime(a,e),this._adsrGain.gain.setTargetAtTime(0,e,t),this._adsrGainParameter.cancelScheduledValues(e),this._adsrGainParameter.setValueAtTime(a,e),this._adsrGainParameter.setTargetAtTime(0,e,t)}connect(e){this._adsrGain.connect(e)}disconnect(){this._adsrGain.disconnect()}reset(e=this._audioContext.currentTime){this._adsrGain.gain.cancelScheduledValues(e),this._adsrGain.gain.setValueAtTime(0,e),this._waveformParameter.cancelScheduledValues(e),this._waveformParameter.setValueAtTime(0,e),this._frequencyParameter.cancelScheduledValues(e),this._frequencyParameter.setValueAtTime(0,e),this._widthParameter.cancelScheduledValues(e),this._widthParameter.setValueAtTime(.5,e),this._syncParameter.cancelScheduledValues(e),this._syncParameter.setValueAtTime(0,e),this._rngParameter.cancelScheduledValues(e),this._rngParameter.setValueAtTime(0,e),this._attackDurationParameter.cancelScheduledValues(e),this._attackDurationParameter.setValueAtTime(.002,e),this._decayDurationParameter.cancelScheduledValues(e),this._decayDurationParameter.setValueAtTime(.006,e),this._sustainLevelParameter.cancelScheduledValues(e),this._sustainLevelParameter.setValueAtTime(0,e),this._releaseDurationParameter.cancelScheduledValues(e),this._releaseDurationParameter.setValueAtTime(.006,e),this._adsrGainParameter.cancelScheduledValues(e),this._adsrGainParameter.setValueAtTime(0,e)}}const l=(e,t,a,i,s)=>t+(a-t)/(1+Math.exp(-s*(e-i))),u=e=>l(e,253.7,1786,776.6,.01395),o=e=>l(e,406,6032,979.5,.0108),c=e=>l(e,317.2,2447,838.8,.01555),h=(e,t,a,i,s)=>{if(e<=t)return 0;if(e>=a)return 2047;const n=i-Math.log((a-e)/(e-t))/s;return Math.max(Math.min(n,2047),0)},d=e=>h(e,253.7,1786,776.6,.01395),_=e=>h(e,406,6032,979.5,.0108),m=e=>h(e,317.2,2447,838.8,.01555),g=(e,t,a,i,s,n)=>(t*e**2+a*e+i-n)/s;class f{_audioContext;_inNode;_lowPass;_highPass;_bandPass;_bandPassPeak;_outNode;_in_out;_in_low;_in_band;_in_high;_low_band;_low_high;_band_high;_low_out;_band_out;_high_out;constructor(e){this._audioContext=e,this._inNode=new GainNode(e,{gain:1}),this._lowPass=new BiquadFilterNode(e,{type:"lowpass"}),this._highPass=new BiquadFilterNode(e,{type:"highpass"}),this._bandPass=new BiquadFilterNode(e,{type:"bandpass",Q:1}),this._bandPassPeak=new BiquadFilterNode(e,{type:"peaking",Q:1}),this._outNode=new GainNode(e,{gain:1}),this._in_out=new GainNode(e,{gain:1}),this._in_low=new GainNode(e,{gain:0}),this._in_band=new GainNode(e,{gain:0}),this._in_high=new GainNode(e,{gain:0}),this._low_band=new GainNode(e,{gain:0}),this._low_high=new GainNode(e,{gain:0}),this._band_high=new GainNode(e,{gain:0}),this._low_out=new GainNode(e,{gain:0}),this._band_out=new GainNode(e,{gain:0}),this._high_out=new GainNode(e,{gain:0}),this._inNode.connect(this._in_out),this._in_out.connect(this._outNode),this._inNode.connect(this._in_low),this._in_low.connect(this._lowPass),this._inNode.connect(this._in_band),this._in_band.connect(this._bandPass),this._bandPass.connect(this._bandPassPeak),this._inNode.connect(this._in_high),this._in_high.connect(this._highPass),this._lowPass.connect(this._low_band),this._low_band.connect(this._bandPass),this._lowPass.connect(this._low_high),this._low_high.connect(this._highPass),this._bandPassPeak.connect(this._band_high),this._band_high.connect(this._highPass),this._lowPass.connect(this._low_out),this._low_out.connect(this._outNode),this._bandPassPeak.connect(this._band_out),this._band_out.connect(this._outNode),this._highPass.connect(this._high_out),this._high_out.connect(this._outNode)}get inNode(){return this._inNode}get lowPassFilter(){return this._lowPass}get highPassFilter(){return this._highPass}get bandPassFilter(){return this._bandPass}get bandPassPeakFilter(){return this._bandPassPeak}c64Frequency(e,t=this._audioContext.currentTime){this._highPass.frequency.setValueAtTime(o(e),t),this._lowPass.frequency.setValueAtTime(u(e),t);const a=c(e);this._bandPass.frequency.setValueAtTime(a,t),this._bandPassPeak.frequency.setValueAtTime(a,t)}frequency(e,t=this._audioContext.currentTime){this._highPass.frequency.setValueAtTime(e,t),this._lowPass.frequency.setValueAtTime(e,t),this._bandPass.frequency.setValueAtTime(e,t),this._bandPassPeak.frequency.setValueAtTime(e,t)}c64Resonance(e,t=this._audioContext.currentTime){this._highPass.Q.setValueAtTime((e=>g(e,-.0148,.6794,.1406,.9393,.0526))(e),t),this._lowPass.Q.setValueAtTime((e=>g(e,-.0142,.6892,-.0047,1.0014,-.0762))(e),t),this._bandPassPeak.gain.setValueAtTime((e=>g(e,-.0125,.6889,.0649,1.0167,.2444))(e),t)}resonance(e,t=this._audioContext.currentTime){this._highPass.Q.setValueAtTime(e,t),this._lowPass.Q.setValueAtTime(e,t),this._bandPassPeak.gain.setValueAtTime(e,t)}c64FilterType(e,t=this._audioContext.currentTime){const a=[];1&e&&a.push("lowpass"),2&e&&a.push("bandpass"),4&e&&a.push("highpass"),this.filterType(a,t)}filterType(e,t=this._audioContext.currentTime){e.includes("lowpass")&&e.includes("bandpass")&&e.includes("highpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(1,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(1,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(1,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(1,t)):e.includes("lowpass")&&e.includes("bandpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(1,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(1,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(1,t),this._high_out.gain.setValueAtTime(0,t)):e.includes("lowpass")&&e.includes("highpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(1,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(1,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(1,t)):e.includes("bandpass")&&e.includes("highpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(0,t),this._in_band.gain.setValueAtTime(1,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(1,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(1,t)):e.includes("lowpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(1,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(1,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(0,t)):e.includes("bandpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(0,t),this._in_band.gain.setValueAtTime(1,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(1,t),this._high_out.gain.setValueAtTime(0,t)):e.includes("highpass")?(this._in_out.gain.setValueAtTime(0,t),this._in_low.gain.setValueAtTime(0,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(1,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(1,t)):(this._in_out.gain.setValueAtTime(1,t),this._in_low.gain.setValueAtTime(0,t),this._in_band.gain.setValueAtTime(0,t),this._in_high.gain.setValueAtTime(0,t),this._low_band.gain.setValueAtTime(0,t),this._low_high.gain.setValueAtTime(0,t),this._band_high.gain.setValueAtTime(0,t),this._low_out.gain.setValueAtTime(0,t),this._band_out.gain.setValueAtTime(0,t),this._high_out.gain.setValueAtTime(0,t))}connect(e){this._outNode.connect(e)}disconnect(){this._outNode.disconnect()}reset(e=this._audioContext.currentTime){this._highPass.frequency.cancelScheduledValues(e),this._highPass.frequency.setValueAtTime(0,e),this._highPass.Q.cancelScheduledValues(e),this._highPass.Q.setValueAtTime(1,e),this._lowPass.frequency.cancelScheduledValues(e),this._lowPass.frequency.setValueAtTime(0,e),this._lowPass.Q.cancelScheduledValues(e),this._lowPass.Q.setValueAtTime(1,e),this._bandPass.frequency.cancelScheduledValues(e),this._bandPass.frequency.setValueAtTime(0,e),this._bandPassPeak.frequency.cancelScheduledValues(e),this._bandPassPeak.frequency.setValueAtTime(0,e),this._bandPassPeak.gain.cancelScheduledValues(e),this._bandPassPeak.gain.setValueAtTime(1,e),this._in_out.gain.cancelScheduledValues(e),this._in_out.gain.setValueAtTime(1,e),this._in_low.gain.cancelScheduledValues(e),this._in_low.gain.setValueAtTime(0,e),this._in_band.gain.cancelScheduledValues(e),this._in_band.gain.setValueAtTime(0,e),this._in_high.gain.cancelScheduledValues(e),this._in_high.gain.setValueAtTime(0,e),this._low_band.gain.cancelScheduledValues(e),this._low_band.gain.setValueAtTime(0,e),this._low_high.gain.cancelScheduledValues(e),this._low_high.gain.setValueAtTime(0,e),this._band_high.gain.cancelScheduledValues(e),this._band_high.gain.setValueAtTime(0,e),this._low_out.gain.cancelScheduledValues(e),this._low_out.gain.setValueAtTime(0,e),this._band_out.gain.cancelScheduledValues(e),this._band_out.gain.setValueAtTime(0,e),this._high_out.gain.cancelScheduledValues(e),this._high_out.gain.setValueAtTime(0,e)}}class v{_audioContext;_mainGain;_oscillator;_voice1;_voice2;_voice3;_filter;_v1_gain;_v1_filter;_v1_main;_v2_gain;_v2_filter;_v2_main;_v3_gain;_v3_switch;_v3_filter;_v3_main;constructor(e=new AudioContext){this._audioContext=e,this._mainGain=new GainNode(e,{gain:1}),this._oscillator=new n(e),this._voice1=new r(e,this._oscillator.voice1Params),this._voice2=new r(e,this._oscillator.voice2Params),this._voice3=new r(e,this._oscillator.voice3Params),this._filter=new f(e),this._v1_gain=new GainNode(e,{gain:1/3}),this._v1_filter=new GainNode(e,{gain:0}),this._v1_main=new GainNode(e,{gain:1}),this._v2_gain=new GainNode(e,{gain:1/3}),this._v2_filter=new GainNode(e,{gain:0}),this._v2_main=new GainNode(e,{gain:1}),this._v3_gain=new GainNode(e,{gain:1/3}),this._v3_switch=new GainNode(e,{gain:1}),this._v3_filter=new GainNode(e,{gain:0}),this._v3_main=new GainNode(e,{gain:1}),this._oscillator.connect(this._voice1.inNode,0),this._voice1.connect(this._v1_gain),this._v1_gain.connect(this._v1_filter),this._v1_filter.connect(this._filter.inNode),this._v1_gain.connect(this._v1_main),this._v1_main.connect(this._mainGain),this._oscillator.connect(this._voice2.inNode,1),this._voice2.connect(this._v2_gain),this._v2_gain.connect(this._v2_filter),this._v2_filter.connect(this._filter.inNode),this._v2_gain.connect(this._v2_main),this._v2_main.connect(this._mainGain),this._oscillator.connect(this._voice3.inNode,2),this._voice3.connect(this._v3_switch),this._v3_switch.connect(this._v3_gain),this._v3_gain.connect(this._v3_filter),this._v3_filter.connect(this._filter.inNode),this._v3_gain.connect(this._v3_main),this._v3_main.connect(this._mainGain),this._filter.connect(this._mainGain)}start(){return this._audioContext.resume()}get voice1(){return this._voice1}get voice2(){return this._voice2}get voice3(){return this._voice3}get voices(){return[this._voice1,this._voice2,this._voice3]}get filter(){return this._filter}c64FilterVoice(e,t=this._audioContext.currentTime){this.filterVoice(0,1&e?1:0,t),this.filterVoice(1,2&e?1:0,t),this.filterVoice(2,4&e?1:0,t)}filterVoice(e,t,a=this._audioContext.currentTime){switch(e){case 0:this._v1_filter.gain.setValueAtTime(t,a),this._v1_main.gain.setValueAtTime(1-t,a);break;case 1:this._v2_filter.gain.setValueAtTime(t,a),this._v2_main.gain.setValueAtTime(1-t,a);break;case 2:this._v3_filter.gain.setValueAtTime(t,a),this._v3_main.gain.setValueAtTime(1-t,a)}}c64Voice3Off(e,t=this._audioContext.currentTime){this.voice3Off(Boolean(e),t)}voice3Off(e,t=this._audioContext.currentTime){this._v3_switch.gain.setValueAtTime(e?0:1,t)}c64Volume(e,t=this._audioContext.currentTime){this.volume(e/15,t)}volume(e,t=this._audioContext.currentTime){this._mainGain.gain.setValueAtTime(e,t)}connect(e,t,a){this._mainGain.connect(e,t,a)}disconnect(){this._mainGain.disconnect()}reset(e=this._audioContext.currentTime){this._mainGain.gain.cancelScheduledValues(e),this._mainGain.gain.setValueAtTime(1,e),this._voice1.reset(e),this._voice2.reset(e),this._voice3.reset(e),this._filter.reset(e),this._v1_gain.gain.cancelScheduledValues(e),this._v1_gain.gain.setValueAtTime(1/3,e),this._v1_filter.gain.cancelScheduledValues(e),this._v1_filter.gain.setValueAtTime(0,e),this._v1_main.gain.cancelScheduledValues(e),this._v1_main.gain.setValueAtTime(1,e),this._v2_gain.gain.cancelScheduledValues(e),this._v2_gain.gain.setValueAtTime(1/3,e),this._v2_filter.gain.cancelScheduledValues(e),this._v2_filter.gain.setValueAtTime(0,e),this._v2_main.gain.cancelScheduledValues(e),this._v2_main.gain.setValueAtTime(1,e),this._v3_gain.gain.cancelScheduledValues(e),this._v3_gain.gain.setValueAtTime(1/3,e),this._v3_switch.gain.cancelScheduledValues(e),this._v3_switch.gain.setValueAtTime(1,e),this._v3_filter.gain.cancelScheduledValues(e),this._v3_filter.gain.setValueAtTime(0,e),this._v3_main.gain.cancelScheduledValues(e),this._v3_main.gain.setValueAtTime(1,e)}}},109:(e,t,a)=>{a.a(e,(async(e,t)=>{try{var i=a(674),s=a(124),n=a(329),r=e([s]);s=(r.then?(await r)():r)[0];const l=[];for(let e=0;e<96;e++)l[e]=document.getElementById(`k${e}`);const u=[];for(let e=0;e<5;e++)u[e]=document.getElementById(`line${e}`);const o=document.getElementById("fileSelect"),c=document.getElementById("openFileLabel"),h=document.getElementById("openFile"),d=document.getElementById("clear"),_=document.getElementById("playPause"),m=document.getElementById("current"),g=document.getElementById("timeslider"),f=document.getElementById("duration"),v={isLoading:!1,isPlaying:!1,durationLeft:0,voicesDataLeft:[],durationRight:0,voicesDataRight:[],fileSelectValue:"",openFileValue:"",notes:[[],[],[],[],[],[]],currentNotes:[-1,-1,-1,-1,-1,-1],text:[],startTime:0,currentTime:0,audioContextStartTime:s.es.currentTime},p=new Proxy(v,{set(e,t,a){if(["notes","currentNotes"].includes(t))for(let t=0;t<6;t++)N(e.currentNotes[t]>=0&&e.notes[t].length>0?e.notes[t][e.currentNotes[t]].index:-1);return e[t]=a,["notes","currentNotes","currentTime"].includes(t)&&A(),["text"].includes(t)&&P(),["fileSelectValue","openFileValue"].includes(t)&&k(),["isLoading","isPlaying","durationLeft","voicesDataLeft","durationRight","currentTime"].includes(t)&&x(),["notes"].includes(t)&&((e.notes[0].length>0||e.notes[1].length>0||e.notes[2].length>0)&&(e.notes[3].length>0||e.notes[4].length>0||e.notes[5].length>0)?(0,s.vD)():(0,s.Wx)()),!0}}),b=()=>Math.max(p.durationLeft,p.durationRight),T=e=>{const t=Math.floor(e/60),a=Math.floor(e-60*t);return`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`},y="rgb(0, 0, 0)",V=(e,t,a)=>{const i=document.createElement("span");return i.style.color=a?y:t,i.style.backgroundColor=a?t:y,i.innerText=e,i},w=e=>e.replace(/^.*[\\/]/,""),A=()=>{for(let e=0;e<6;e++)if(0!==p.notes[e].length){const t=p.currentTime,a=p.currentNotes[e]>=0?p.notes[e][p.currentNotes[e]]:void 0;if(!a||t<a.start||t>=a.stop){N(a&&a.index||-1);let i=-1;for(let a=0;a<p.notes[e].length;a++)if(t>=p.notes[e][a].start&&t<p.notes[e][a].stop){i=a;break}v.currentNotes[e]=i,i>0&&R(p.notes[e][i].index,e)}}},P=()=>{for(let e=0;e<5;e++)u[e].textContent="";let e=0,t="",a=0,s=[0,0,0,0,0],r=i.sR.wht.rgba(),l=!1;e:for(const o of p.text)switch(o){case 0:t&&u[e].append(V(t,r,l));break e;case 13:u[e].append(V(t,r,l)),s[e]=a,e++,t="",a=0,l=!1;break;case 5:u[e].append(V(t,r,l)),t="",r=i.sR.wht.rgba();break;case 18:u[e].append(V(t,r,l)),t="",l=!0;break;case 28:u[e].append(V(t,r,l)),t="",r=i.sR.red.rgba();break;case 30:u[e].append(V(t,r,l)),t="",r=i.sR.grn.rgba();break;case 31:u[e].append(V(t,r,l)),t="",r=i.sR.blu.rgba();break;case 129:u[e].append(V(t,r,l)),t="",r=i.sR.orng.rgba();break;case 144:u[e].append(V(t,r,l)),t="",r=i.sR.blk.rgba();break;case 146:u[e].append(V(t,r,l)),t="",l=!1;break;case 149:u[e].append(V(t,r,l)),t="",r=i.sR.brn.rgba();break;case 150:u[e].append(V(t,r,l)),t="",r=i.sR.lred.rgba();break;case 151:u[e].append(V(t,r,l)),t="",r=i.sR.dgry.rgba();break;case 152:u[e].append(V(t,r,l)),t="",r=i.sR.mgry.rgba();break;case 153:u[e].append(V(t,r,l)),t="",r=i.sR.lgrn.rgba();break;case 154:u[e].append(V(t,r,l)),t="",r=i.sR.lblu.rgba();break;case 155:u[e].append(V(t,r,l)),t="",r=i.sR.lgry.rgba();break;case 156:u[e].append(V(t,r,l)),t="",r=i.sR.pur.rgba();break;case 158:u[e].append(V(t,r,l)),t="",r=i.sR.yel.rgba();break;case 159:u[e].append(V(t,r,l)),t="",r=i.sR.cyn.rgba();break;default:t+=n.p[o]||"?",a++}for(let e=0;e<5;e++)s[e]<32&&u[e].append(V(" ".repeat(32-s[e]),r,!1))},k=()=>{o.value=p.fileSelectValue,c.textContent=p.openFileValue?w(p.openFileValue):"--OPEN--",!p.openFileValue&&(h.value=p.openFileValue)},x=()=>{_.disabled=0===p.voicesDataLeft.length||p.isLoading,p.isPlaying?_.classList.add("paused"):_.classList.remove("paused"),m.textContent=T(p.currentTime),g.disabled=0===p.voicesDataLeft.length||p.isLoading,g.max=String(b()),g.value=String(p.currentTime),f.textContent=T(b())},S=async(e,t)=>{G(),p.isLoading=!0,p.isPlaying=!1;const{voicesData:a,duration:i,text:n,notes:r}=await(0,s.ZN)(e,t);"right"===e?(p.durationRight=i,p.voicesDataRight=a,p.notes=[p.notes[0],p.notes[1],p.notes[2],r[0],r[1],r[2]],p.currentNotes=[p.currentNotes[0],p.currentNotes[1],p.currentNotes[2],-1,-1,-1]):(p.durationLeft=i,p.voicesDataLeft=a,p.notes=[r[0],r[1],r[2],p.notes[3],p.notes[4],p.notes[5]],p.currentNotes=[-1,-1,-1,p.currentNotes[3],p.currentNotes[4],p.currentNotes[5]],p.text=n),p.startTime=0,p.currentTime=0,p.audioContextStartTime=s.es.currentTime,p.isLoading=!1},q=()=>{G(),p.isLoading=!1,p.isPlaying=!1,p.durationLeft=0,p.voicesDataLeft=[],p.durationRight=0,p.voicesDataRight=[],p.fileSelectValue="",p.openFileValue="",p.notes=[[],[],[],[],[],[]],p.currentNotes=[-1,-1,-1,-1,-1,-1],p.text=[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,13,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,13,32,32,32,32,32,32,32,32,83,69,76,69,67,84,32,65,32,83,73,68,32,70,73,76,69,32,32,32,32,32,32,32,13,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,13,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0],p.startTime=0,p.currentTime=0,p.audioContextStartTime=s.es.currentTime};h.onchange=e=>{const t=e.target.value;if(t){p.openFileValue=t,p.fileSelectValue="";const a=e.target.files;for(const e of a)e.name.endsWith(".mus")?S("left",e):e.name.endsWith(".str")&&S("right",e)}},o.onchange=async e=>{const t=e.target.value;if(t){p.fileSelectValue=t,p.openFileValue="";const e=t.split(",");for(const t of e){const e=await fetch(`sids/${t}`),a=await e.blob();t.endsWith(".mus")?S("left",a):t.endsWith(".str")&&S("right",a)}}},d.onclick=()=>{q()};const N=e=>{if(e<0||e>=l.length)return;const t=[0,2,4,5,7,9,11].includes(e%12)?"linear-gradient(to bottom, #fff, #e0e0e0)":"linear-gradient(to bottom, #222, #000)";l[e].style.background=t},C={0:"#eeee77ff",1:"#664400ff",2:"#cc44ccff",3:"#f8f8bfff",4:"#ae9158ff",5:"#df97dfff"},R=(e,t)=>{l[e].style.background=C[t]},F=()=>{M||(M=setInterval(L,20)),s.es.resume()},G=()=>{M&&(clearInterval(M),M=void 0),s.es.suspend()};_.onclick=()=>{p.isPlaying?(G(),p.isPlaying=!1):(F(),p.isPlaying=!0)};const D=e=>{p.isLoading=!0,p.startTime=Number(e.target.value),p.currentTime=Number(e.target.value),p.audioContextStartTime=s.es.currentTime,p.voicesDataLeft.length>0&&(0,s.F9)("left",p.voicesDataLeft,p.startTime),p.voicesDataRight.length>0&&(0,s.F9)("right",p.voicesDataRight,p.startTime),p.currentNotes=[-1,-1,-1,-1,-1,-1],p.isLoading=!1};let M;g.onmousedown=e=>{G()},g.ontouchstart=e=>{G()},g.oninput=e=>{p.currentTime=Number(e.target.value)},g.onmouseup=e=>{D(e),p.isPlaying&&F()},g.ontouchend=e=>{D(e),p.isPlaying&&F()};const L=()=>{p.currentTime=p.startTime+s.es.currentTime-p.audioContextStartTime,p.currentTime>b()&&(G(),p.isPlaying=!1)};t()}catch(e){t(e)}}))},124:(e,t,a)=>{a.a(e,(async(e,i)=>{try{a.d(t,{F9:()=>y,Wx:()=>o,ZN:()=>T,es:()=>e,vD:()=>c});var s=a(27),n=a(329);const e=new AudioContext;await e.audioWorklet.addModule("C64SidProcessor.js"),await e.suspend();try{if("function"!=typeof e.createGain().gain.cancelAndHoldAtTime)throw new Error("Unsupported browser: cancelAndHoldAtTime not available.")}catch(e){throw console.error("Error during feature detection:",e),document.getElementById("main-content").style.display="none",document.getElementById("unsupported-message").style.display="block",e}const r=new s.hz(e),l=new s.hz(e),u=new ChannelMergerNode(e,{numberOfInputs:2});r.connect(e.destination);const o=()=>{r.connect(e.destination),l.disconnect(),u.disconnect()},c=()=>{r.connect(u,0,0),l.connect(u,0,1),u.connect(e.destination)},h=(e,t,a,i,n)=>{if("rst"===e)return{index:-1,frequency:0};let r={c:0,d:2,e:4,f:5,g:7,a:9,b:11,rst:NaN}[e];switch(t){case"flt":r--;break;case"nat":default:break;case"shp":r++;break;case"dbl":["g","f","d","c"].includes(e)?r+=2:["a","b","e"].includes(e)&&(r-=2)}return r+=12*a,r+=n,{index:r,frequency:440*2**((r-57)/12)+i*s.pu}},d=(e,t,a,i)=>{let s;switch(e){case"whl":s=4;break;case"hlf":s=2;break;case"qtr":default:s=1;break;case"8th":s=.5;break;case"16th":s=1/4;break;case"32nd":s=1/8;break;case"64th":s=1/16;break;case"utl":return i/60}switch(t){case"non":default:break;case"sgl":s*=1.5;break;case"dbl":s*=1.75}return 60/a*s},_=(e,t,a,i,n,r)=>{if(0===n.rate&&0===r.depth)e.frequency(a,t);else if(0!==n.rate){const l=Math.sign(a-n.startFrequency)*n.rate*60*s.pu;if(Math.abs(a-n.startFrequency)>=Math.abs(l*i)){const a=n.startFrequency+l*i;e.frequency(n.startFrequency,t),e.frequencyParam.linearRampToValueAtTime(a,t+i)}else{const s=(a-n.startFrequency)/l;e.frequency(n.startFrequency,t),e.frequencyParam.linearRampToValueAtTime(a,t+s),0!==r.depth&&_(e,t+s,a,i-s,{...n,rate:0},r)}}else{const n=60*r.depth*s.pu,l=a+r.depth*s.pu*r.rate;let u=0,o=!0;e.frequency(a,t);do{u+r.rate/60<i?(u+=r.rate/60,o?(e.frequencyParam.linearRampToValueAtTime(l,t+u),e.frequency(l,t+u)):(e.frequencyParam.linearRampToValueAtTime(a,t+u),e.frequency(a,t+u))):(o?(e.frequencyParam.linearRampToValueAtTime(a+n*(i-u),t+i),e.frequency(a+n*(i-u),t+u)):(e.frequencyParam.linearRampToValueAtTime(l-n*(i-u),t+i),e.frequency(l-n*(i-u),t+u)),u=i),o=!o}while(u<i)}},m=(e,t,a,i,s)=>{const n=60*i;let r=0,l=a;e.widthParam.setValueAtTime(a/4095,t);do{n>0&&r+(4095-l)/n<s?(r+=(4095-l)/n,l=0,e.widthParam.linearRampToValueAtTime(1,t+r),e.widthParam.setValueAtTime(0,t+r)):n<0&&r-l/n<s?(r-=l/n,l=4095,e.widthParam.linearRampToValueAtTime(0,t+r),e.widthParam.setValueAtTime(1,t+r)):(e.widthParam.linearRampToValueAtTime((l+n*(s-r))/4095,t+s),r=s)}while(r<s);e.widthParam.setValueAtTime(a/4095,t+s)},g=(e,t,a,i)=>{const s=e+t*a,n=Math.max(Math.floor(60*a),2),r=(s-e)/(n-1),l=[];let u=e;for(let e=0;e<n;e++)l.push(i(u)),u+=r;return l},f=(e,t,a,i,n)=>{const r=60*i;let l=0,u=a;e.c64Frequency(a,t);do{if(r>0&&l+(2047-u)/r<n){const a=(2047-u)/r;e.lowPassFilter.frequency.setValueCurveAtTime(g(u,r,a,s.Ax),t+l,a),e.highPassFilter.frequency.setValueCurveAtTime(g(u,r,a,s.Wi),t+l,a);const i=g(u,r,a,s.br);e.bandPassFilter.frequency.setValueCurveAtTime(i,t+l,a),e.bandPassPeakFilter.frequency.setValueCurveAtTime(i,t+l,a),l+=a,u=0}else if(r<0&&l-u/r<n){const a=-u/r;e.lowPassFilter.frequency.setValueCurveAtTime(g(u,r,a,s.Ax),t+l,a),e.highPassFilter.frequency.setValueCurveAtTime(g(u,r,a,s.Wi),t+l,a);const i=g(u,r,a,s.br);e.bandPassFilter.frequency.setValueCurveAtTime(i,t+l,a),e.bandPassPeakFilter.frequency.setValueCurveAtTime(i,t+l,a),l+=a,u=2047}else{const a=n-l-1e-6;e.lowPassFilter.frequency.setValueCurveAtTime(g(u,r,a,s.Ax),t+l,a),e.highPassFilter.frequency.setValueCurveAtTime(g(u,r,a,s.Wi),t+l,a);const i=g(u,r,a,s.br);e.bandPassFilter.frequency.setValueCurveAtTime(i,t+l,a),e.bandPassPeakFilter.frequency.setValueCurveAtTime(i,t+l,a),l=n}}while(l<n);e.c64Frequency(a,t+n)},v=(e,t,a,i,n)=>{const r=2*a;let l=n.includes("lowpass")?(0,s.Lo)(r):n.includes("highpass")?(0,s.Rl)(r):(0,s.Qq)(r);return l=Math.max(Math.min(l+i,2047),0),e.c64Frequency(l,t),l},p=e=>{const t=e.voices;for(let e=0;e<t.length;e++)t[e].c64Waveform(4),t[e].c64AttackDuration(2),t[e].c64DecayDuration(0),t[e].c64SustainLevel(15),t[e].c64ReleaseDuration(5),t[e].c64PulseWidth(2048);e.c64Volume(8)},b=(t,a,i)=>{const s=t.voices;p(t);const n=[[],[],[]],r=e.currentTime;let l=r,u=100,o=8,c=12;const g=[];for(let e=0;e<s.length;e++)g.push({cmdPointer:{voice:e,index:0},callStack:[],hed:{pointer:{voice:e,index:0},count:1},time:r,releasePoint:4,detune:0,transpose:0,tie:!1,portamentoRate:0,portamentoStartFrequency:0,pulseWidth:2048,pulseWidthSweepRate:0,vibratoRate:0,vibratoDepth:0,filter:[],filterFrequency:0,filterFrequencySweepRate:0,autoFilter:0,halt:!1});let b=0;const T=[];for(let e=0;e<a.length;e++)for(let t=0;t<a[e].length;t++){const i=a[e][t];"def"===i.type&&T.push({index:i.data.value,pointer:{voice:e,index:t}})}do{let{cmdPointer:e,callStack:p,hed:y,time:V,releasePoint:w,detune:A,transpose:P,tie:k,portamentoRate:x,portamentoStartFrequency:S,pulseWidth:q,pulseWidthSweepRate:N,vibratoRate:C,vibratoDepth:R,filter:F,filterFrequency:G,filterFrequencySweepRate:D,autoFilter:M,halt:L}=g[b];for(;!L&&e.index<a[e.voice].length&&V<=l;){const l=a[e.voice][e.index];switch(l.type){case"tem":u=l.data.value;break;case"utl":c=l.data.value;break;case"vol":o=l.data.value,t.c64Volume(o,Math.max(V-i,r));break;case"bmp":"up"===l.data.value&&o<15&&o++,"down"===l.data.value&&o>0&&o--,t.c64Volume(o,Math.max(V-i,r));break;case"hed":y={pointer:{...e},count:l.data.value-1};break;case"tal":y.count>0&&(e={...y.pointer},y.count--);break;case"cal":const a=T.find((e=>e.index===l.data.value));if(!a)throw new Error(`UNDEFINED PHRASE CALL: ${JSON.stringify(e)}, ${JSON.stringify(l)}`);if(p.push({pointer:{...e},cmd:"cal"}),p.length>255)throw new Error(`STACK OVERFLOW: ${JSON.stringify(e)}, ${JSON.stringify(l)}`);e={...a.pointer};break;case"def":if(p.push({pointer:{...e},cmd:"def"}),p.length>255)throw new Error(`STACK OVERFLOW: ${JSON.stringify(e)}, ${JSON.stringify(l)}`);break;case"end":if(0===p.length)throw new Error(`STACK UNDERFLOW: ${JSON.stringify(e)}, ${JSON.stringify(l)}`);const g=p.pop();"cal"===g.cmd&&(e={...g.pointer});break;case"f-m":F=l.data.value.slice(),t.filter.filterType(l.data.value,Math.max(V-i,r));break;case"aut":M=l.data.value;break;case"res":t.filter.c64Resonance(l.data.value,Math.max(V-i,r));break;case"flt":t.filterVoice(b,"yes"===l.data.value?1:0,Math.max(V-i,r));break;case"f-s":D=l.data.value;break;case"f-c":G=8*l.data.value,t.filter.c64Frequency(G,Math.max(V-i,r));break;case"f-x":case"ms#":case"flg":case"aux":break;case"atk":s[b].c64AttackDuration(l.data.value,Math.max(V-i,r));break;case"dcy":s[b].c64DecayDuration(l.data.value,Math.max(V-i,r));break;case"sus":s[b].c64SustainLevel(l.data.value,Math.max(V-i,r));break;case"rls":s[b].c64ReleaseDuration(l.data.value,Math.max(V-i,r));break;case"pnt":w=l.data.value;break;case"wav":s[b].waveform(l.data.value,Math.max(V-i,r));break;case"p-w":q=l.data.value,s[b].c64PulseWidth(q,Math.max(V-i,r));break;case"p-s":N=l.data.value;break;case"snc":s[b].sync("yes"===l.data.value,Math.max(V-i,r));break;case"rng":s[b].rng("yes"===l.data.value,Math.max(V-i,r));break;case"vdp":R=l.data.value;break;case"vrt":C=l.data.value;break;case"por":x=l.data.value;break;case"dtn":A=l.data.value;break;case"tps":P=l.data.value;break;case"3-O":t.voice3Off("yes"===l.data.value,Math.max(V-i,r));break;case"hlt":L=!0;break;case"note":const{index:W,frequency:O}=h(l.data.note,l.data.modifier,l.data.octave,A,P),E=d(l.data.duration,l.data.dotted,u,c);V>=r+i&&0!==O&&(_(s[b],V-i,O,E,{startFrequency:S,rate:x},{depth:R,rate:C}),0!==N&&m(s[b],V-i,q,N,E),0!==M&&(G=v(t.filter,V-i,O,M,F)),0!==D&&f(t.filter,V-i,G,D,E),k||s[b].start(V-i),k=l.data.tie,k||s[b].stop(V-i+Math.max(E-w/60,0)),W>=0&&W<=95&&n[b].push({start:V-r,stop:V-r+Math.max(E-w/60,0),index:W})),V+=E,S=O;break;case"abs":const{frequency:$}=h(l.data.note,l.data.modifier,l.data.octave,A,P);S=$;break;default:console.error(`${l.type} not implemented`)}e.index++}g[b]={cmdPointer:e,callStack:p,hed:y,time:V,releasePoint:w,detune:A,transpose:P,tie:k,portamentoRate:x,portamentoStartFrequency:S,pulseWidth:q,pulseWidthSweepRate:N,vibratoRate:C,vibratoDepth:R,filter:F,filterFrequency:G,filterFrequencySweepRate:D,autoFilter:M,halt:L},V>l&&(l=V),b++,b>=s.length&&(b=0)}while(g.some((e=>!e.halt&&e.cmdPointer.index<a[e.cmdPointer.voice].length)));return{duration:Math.floor(10*Math.max(...g.map((e=>e.time-r))))/10,notes:n}},T=async(e,t)=>{const a=await(0,n.g)(t),{duration:i,notes:s}=y(e,a.voices,0);return{voicesData:a.voices,duration:i,text:a.text,notes:s}},y=(e,t,a)=>{const i="right"===e?l:r;return i.reset(0),b(i,t,a)};i()}catch(e){i(e)}}),1)},329:(e,t,a)=>{a.d(t,{g:()=>n,p:()=>s});const i=(e,t)=>{if(!(3&e)){let a,i;switch(31&e){case 0:a="64th";break;case 28:a="32nd";break;case 24:a="16th";break;case 20:a="8th";break;case 16:a="qtr";break;case 12:a="hlf";break;default:a="whl"}switch(163&e){case 32:i="sgl";break;case 160:i="dbl";break;default:i="non"}const s=64==(67&e);let n,r,l;switch(4==(63&e)&&(a="utl"),36==(63&e)&&(a="utv"),128==(163&e)&&console.warn("triplet not implemented"),160==(191&e)&&console.warn("triplet 64th note not implemented"),192&t){case 192:n="flt";break;case 128:default:n="nat";break;case 64:n="shp";break;case 0:n="dbl"}switch(56&t){case 56:r=0;break;case 48:r=1;break;case 40:r=2;break;case 32:r=3;break;case 24:default:r=4;break;case 16:r=5;break;case 8:r=6;break;case 0:r=7}switch(7&t){case 7:l="b";break;case 6:l="a";break;case 5:l="g";break;case 4:l="f";break;case 3:l="e";break;case 2:l="d";break;case 1:default:l="c";break;case 0:l="rst"}return{type:0===e?"abs":"note",data:{duration:a,dotted:i,tie:s,modifier:n,octave:r,note:l}}}if(1===e){if(!(15&t))return{type:"dcy",data:{value:(240&t)>>>4}};if(1==(7&t))return{type:"rup",data:{value:(248&t)>>>3}};if(2==(15&t))return{type:"cal",data:{value:(240&t)>>>4}};if(3===t)return{type:"bmp",data:{value:"up"}};if(19===t)return{type:"flt",data:{value:"no"}};if(35===t)return{type:"rng",data:{value:"no"}};if(51===t)return{type:"snc",data:{value:"no"}};if(67===t)return{type:"f-x",data:{value:"no"}};if(83===t)return{type:"3-O",data:{value:"no"}};if(131==(143&t))return{type:"def",data:{value:8+((240&t)>>>4)}};if(4==(135&t))return{type:"atk",data:{value:(120&t)>>>3}};if(132==(135&t))return{type:"sus",data:{value:(120&t)>>>3}};if(99===t)return{type:"lfo",data:{value:0}};if(115===t)return{type:"p&v",data:{value:"no"}};if(5==(7&t))return{type:"rdn",data:{value:(248&t)>>>3}};if(6==(15&t))return{type:"def",data:{value:(240&t)>>>4}};if(7==(31&t)){let e;switch(224&t){case 0:e=["noise"];break;case 32:default:e=["triangle"];break;case 64:e=["sawtooth"];break;case 96:e=["triangle","sawtooth"];break;case 128:e=["pulse"];break;case 160:e=["pulse","triangle"];break;case 192:e=["pulse","sawtooth"];break;case 224:e=["pulse","triangle","sawtooth"]}return{type:"wav",data:{value:e}}}if(23==(31&t)){let e;switch(224&t){case 0:default:e=[];break;case 32:e=["lowpass"];break;case 64:e=["bandpass"];break;case 96:e=["lowpass","bandpass"];break;case 128:e=["highpass"];break;case 160:e=["highpass","lowpass"];break;case 192:e=["highpass","bandpass"];break;case 224:e=["highpass","lowpass","bandpass"]}return{type:"f-m",data:{value:e}}}if(8==(15&t))return{type:"rls",data:{value:(240&t)>>>4}};if(10==(15&t))return{type:"res",data:{value:(240&t)>>>4}};if(11===t)return{type:"bmp",data:{value:"down"}};if(27===t)return{type:"flt",data:{value:"yes"}};if(43===t)return{type:"rng",data:{value:"yes"}};if(59===t)return{type:"snc",data:{value:"yes"}};if(75===t)return{type:"f-x",data:{value:"yes"}};if(91===t)return{type:"3-O",data:{value:"yes"}};if(107===t)return{type:"lfo",data:{value:1}};if(123===t)return{type:"p&v",data:{value:"yes"}};if(139==(143&t))return{type:"cal",data:{value:8+((240&t)>>>4)}};if(14==(15&t))return{type:"vol",data:{value:(240&t)>>>4}};if(15===t)return{type:"tal"};if(47===t)return{type:"end"};if(79===t)return{type:"hlt"};if(31==(159&t))return{type:"src",data:{value:(96&t)>>>5}};if(!(143&~t)){let e;switch(112&t){case 0:default:e=0;break;case 32:e=1;break;case 80:e=2;break;case 96:e=3}return{type:"dst",data:{value:e}}}}else{if(2==(15&e))return{type:"p-w",data:{value:((240&e)<<4)+t}};if(6===e)return{type:"tem",data:{value:Math.trunc(14400/(0!==t?t:256))}};if(22===e)return{type:"utl",data:{value:0!==t?t:256}};if(38===e)return{type:"pnt",data:{value:t}};if(54===e)return{type:"hed",data:{value:t}};if(70===e)return{type:"flg",data:{value:t}};if(86===e)return{type:"p-s",data:{value:t<<24>>24}};if(102===e)return{type:"f-s",data:{value:t<<24>>24}};if(110===e)return{type:"sca",data:{value:t<<24>>24}};if(118===e)return{type:"vdp",data:{value:t}};if(134===e)return{type:"vrt",data:{value:0!==t?t:256}};if(150===e)return{type:"aut",data:{value:t<<24>>24}};if(166===e)return{type:"tps",data:{value:(1&t?-1:1)*(12*(1&t?(14&t)>>>1:7-((14&t)>>>1))+(1&t?11-((240&t)>>>4):(240&t)>>>4))}};if(182===e)return{type:"aux",data:{value:t}};if(198===e)return{type:"pvd",data:{value:t}};if(214===e)return{type:"pvr",data:{value:t}};if(230===e)return{type:"max",data:{value:t}};if(246===e)return{type:"utv",data:{value:t}};if(14===e)return{type:"f-c",data:{value:t}};if(46===e)return{type:"rtp",data:{octaves:3-(7&t),halfsteps:((248&t)>>>3)-11}};if(78===e)return{type:"hld",data:{value:t}};if(30===e||94===e||158===e||222===e)return{type:"ms#",data:{value:((192&e)<<2)+t}};if(62===e||126===e||190===e||254===e){let a=(t<<2)+((192&e)>>>6);return t>192&&(a=a<<22>>22),{type:"jif",data:{value:a}}}if(10==(15&e))return{type:"dtn",data:{value:16&e?((224&e)<<3)+t-2048:((224&e)<<3)+t}};if(!(3&~e))return{type:"por",data:{value:((252&e)<<6)+t}}}},s={3:"stop",5:"wht",8:"shOff",9:"shOn",13:"\n",14:"lCase",17:"down",18:"rvsOn",19:"home",20:"del",28:"red",29:"right",30:"grn",31:"blu",32:" ",33:"!",34:'"',35:"#",36:"$",37:"%",38:"&",39:"'",40:"(",41:")",42:"*",43:"+",44:",",45:"-",46:".",47:"/",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",58:":",59:";",60:"<",61:"=",62:">",63:"?",64:"@",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"[",92:"£",93:"]",94:"↑",95:"←",96:"─",97:"♠",98:"🭲",99:"🭸",100:"🭷",101:"🭶",102:"🭺",103:"🭱",104:"🭴",105:"╮",106:"╰",107:"╯",108:"🭼",109:"╲",110:"╱",111:"🭽",112:"🭾",113:"•",114:"🭻",115:"♥",116:"🭰",117:"╭",118:"╳",119:"○",120:"♣",121:"🭵",122:"♦",123:"┼",124:"🮌",125:"│",126:"π",127:"◥",129:"orng",131:"run",133:"f1",134:"f3",135:"f5",136:"f7",137:"f2",138:"f4",139:"f6",140:"f8",141:"shRtrn",142:"uCase",144:"blk",145:"up",146:"rvsOff",147:"clr",148:"inst",149:"brn",150:"lred",151:"dgry",152:"mgry",153:"lgrn",154:"lblu",155:"lgry",156:"pur",157:"left",158:"yel",159:"cyn",160:" ",161:"▌",162:"▄",163:"▔",164:"▁",165:"▏",166:"▒",167:"▕",168:"🮏",169:"◤",170:"🮇",171:"├",172:"▗",173:"└",174:"┐",175:"▂",176:"┌",177:"┴",178:"┬",179:"┤",180:"▎",181:"▍",182:"🮈",183:"🮂",184:"🮃",185:"▃",186:"🭿",187:"▖",188:"▝",189:"┘",190:"▘",191:"▚",192:"─",193:"♠",194:"🭲",195:"🭸",196:"🭷",197:"🭶",198:"🭺",199:"🭱",200:"🭴",201:"╮",202:"╰",203:"╯",204:"🭼",205:"╲",206:"╱",207:"🭽",208:"🭾",209:"•",210:"🭻",211:"♥",212:"🭰",213:"╭",214:"╳",215:"○",216:"♣",217:"🭵",218:"♦",219:"┼",220:"🮌",221:"│",222:"π",223:"◥",224:" ",225:"▌",226:"▄",227:"▔",228:"▁",229:"▏",230:"▒",231:"▕",232:"🮏",233:"◤",234:"🮇",235:"├",236:"▗",237:"└",238:"┐",239:"▂",240:"┌",241:"┴",242:"┬",243:"┤",244:"▎",245:"▍",246:"🮈",247:"🮂",248:"🮃",249:"▃",250:"🭿",251:"▖",252:"▝",253:"┘",254:"▘",255:"π"},n=async e=>{const t=new DataView(await(async e=>new Promise(((t,a)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=a,i.readAsArrayBuffer(e)})))(e));let a=0;t.getUint16(a,!0),a+=2;const s=t.getUint16(a,!0);a+=2;const n=t.getUint16(a,!0);a+=2;const r=t.getUint16(a,!0);a+=2;const l=8+s,u=l+n,o=u+r,c=[];for(let e=8;e<l;e+=2){const a=t.getUint8(e),s=t.getUint8(e+1),n=i(a,s);if(!n){console.error(`unknown command, voiceindex 0, index ${c.length}, byte1 ${a}, byte2 ${s}`);break}c.push(n)}const h=[];for(let e=l;e<u;e+=2){const a=t.getUint8(e),s=t.getUint8(e+1),n=i(a,s);if(!n){console.error(`unknown command, voiceindex 1, index ${h.length}, byte1 ${a}, byte2 ${s}`);break}h.push(n)}const d=[];for(let e=u;e<o;e+=2){const a=t.getUint8(e),s=t.getUint8(e+1),n=i(a,s);if(!n){console.error(`unknown command, voiceindex 2, index ${d.length}, byte1 ${a}, byte2 ${s}`);break}d.push(n)}const _=[];for(let e=o;e<t.byteLength;e++){const a=t.getUint8(e);_.push(a)}return{voices:[c,h,d],text:_}}},674:(e,t,a)=>{a.d(t,{sR:()=>s});class i{r=0;g=0;b=0;a=0;init(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}initRgba(e,t,a,i=255){return this.r=Math.max(Math.min(Math.round(e),255),0),this.g=Math.max(Math.min(Math.round(t),255),0),this.b=Math.max(Math.min(Math.round(a),255),0),this.a=Math.max(Math.min(Math.round(i),255),0),this}static color(e,t,a,s=255){return(new i).initRgba(e,t,a,s)}static greyScaleColor(e,t=255){return(new i).initRgba(e,e,e,t)}static color1(e,t,a,s=1){return(new i).initRgba(255*e,255*t,255*a,255*s)}static greyScaleColor1(e,t=1){return(new i).initRgba(255*e,255*e,255*e,255*t)}static fromUint32(e){return(new i).initRgba(255&e,e>>>8&255,e>>>16&255,e>>>24)}static black=(new i).initRgba(0,0,0);static white=(new i).initRgba(255,255,255);static red=(new i).initRgba(255,0,0);static green=(new i).initRgba(0,255,0);static blue=(new i).initRgba(0,0,255);static transparentBlack=(new i).initRgba(0,0,0,0);uint32(){return this.a<<24|this.b<<16|this.g<<8|this.r}rgba(){return`rgba(${this.r},${this.g},${this.b},${this.a/255})`}mix(e,t){return(new i).initRgba((1-t)*this.r+t*e.r,(1-t)*this.g+t*e.g,(1-t)*this.b+t*e.b)}shadow(e){const t=(e,t)=>{const a=e+t;return a>255?255:a<0?0:a};return(new i).initRgba(t(this.r,e),t(this.g,e),t(this.b,e))}}const s={blk:i.black,wht:i.white,red:i.color(136,0,0),cyn:i.color(170,255,238),pur:i.color(204,68,204),grn:i.color(0,204,85),blu:i.color(0,0,170),yel:i.color(238,238,119),orng:i.color(221,136,85),brn:i.color(102,68,0),lred:i.color(255,119,119),dgry:i.color(51,51,51),mgry:i.color(119,119,119),lgrn:i.color(170,255,102),lblu:i.color(0,136,255),lgry:i.color(187,187,187)}}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return s[e](a,a.exports,r),a.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",a="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},r.a=(s,n,r)=>{var l;r&&((l=[]).d=-1);var u,o,c,h=new Set,d=s.exports,_=new Promise(((e,t)=>{c=t,o=e}));_[t]=d,_[e]=e=>(l&&e(l),h.forEach(e),_.catch((e=>{}))),s.exports=_,n((s=>{var n;u=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[e])return s;if(s.then){var n=[];n.d=0,s.then((e=>{r[t]=e,i(n)}),(e=>{r[a]=e,i(n)}));var r={};return r[e]=e=>e(n),r}}var l={};return l[e]=e=>{},l[t]=s,l})))(s);var r=()=>u.map((e=>{if(e[a])throw e[a];return e[t]})),o=new Promise((t=>{(n=()=>t(r)).r=0;var a=e=>e!==l&&!h.has(e)&&(h.add(e),e&&!e.d&&(n.r++,e.push(n)));u.map((t=>t[e](a)))}));return n.r?o:r()}),(e=>(e?c(_[a]=e):o(d),i(l)))),l&&l.d<0&&(l.d=0)},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(109)})();
//# sourceMappingURL=sidplayer.bundle.js.map