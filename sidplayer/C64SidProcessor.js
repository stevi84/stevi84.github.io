class C64SidProcessor extends AudioWorkletProcessor{#e;#a=0;#o=0;#i=0;#t=0;#s=0;#c=0;#h=0;#v=0;#r=0;constructor(e){super(),this.#e=e.processorOptions.sampleRate}static get parameterDescriptors(){return[{name:"voice1Waveform",defaultValue:0,automationRate:"k-rate"},{name:"voice1Frequency",defaultValue:0,automationRate:"k-rate"},{name:"voice1Width",defaultValue:.5,automationRate:"k-rate"},{name:"voice1Sync",defaultValue:0,automationRate:"k-rate"},{name:"voice1Rng",defaultValue:0,automationRate:"k-rate"},{name:"voice2Waveform",defaultValue:0,automationRate:"k-rate"},{name:"voice2Frequency",defaultValue:0,automationRate:"k-rate"},{name:"voice2Width",defaultValue:.5,automationRate:"k-rate"},{name:"voice2Sync",defaultValue:0,automationRate:"k-rate"},{name:"voice2Rng",defaultValue:0,automationRate:"k-rate"},{name:"voice3Waveform",defaultValue:0,automationRate:"k-rate"},{name:"voice3Frequency",defaultValue:0,automationRate:"k-rate"},{name:"voice3Width",defaultValue:.5,automationRate:"k-rate"},{name:"voice3Sync",defaultValue:0,automationRate:"k-rate"},{name:"voice3Rng",defaultValue:0,automationRate:"k-rate"}]}process(e,a,o){const i=a[0][0].length,t=o.voice1Frequency[0]/this.#e,s=1&o.voice1Waveform[0],c=(2&o.voice1Waveform[0])>>1,h=(4&o.voice1Waveform[0])>>2,v=(8&o.voice1Waveform[0])>>3,r=s+c+h+v,n=o.voice1Width[0],u=Boolean(o.voice1Sync[0]),l=Boolean(o.voice1Rng[0]),P=o.voice2Frequency[0]/this.#e,m=1&o.voice2Waveform[0],f=(2&o.voice2Waveform[0])>>1,d=(4&o.voice2Waveform[0])>>2,R=(8&o.voice2Waveform[0])>>3,V=m+f+d+R,W=o.voice2Width[0],k=Boolean(o.voice2Sync[0]),p=Boolean(o.voice2Rng[0]),y=o.voice3Frequency[0]/this.#e,g=1&o.voice3Waveform[0],M=(2&o.voice3Waveform[0])>>1,S=(4&o.voice3Waveform[0])>>2,q=(8&o.voice3Waveform[0])>>3,B=g+M+S+q,F=o.voice3Width[0],C=Boolean(o.voice3Sync[0]),x=Boolean(o.voice3Rng[0]);for(let e=0;e<i;e++){const o=(l&&this.#h>=.5?-1:1)*(this.#a<.5?4*this.#a-1:3-4*this.#a),i=2*this.#a-1,A=this.#a<n?-1:1,D=this.#i;a[0][0][e]=0!==t?(s*o+c*i+h*A+v*D)/r:0,this.#o+=16*t,this.#o>=1&&(this.#o-=Math.floor(this.#o),this.#i=2*Math.random()-1),this.#a+=t,this.#a>=1&&(k&&(this.#t=(this.#a-1)/t*P),this.#a-=Math.floor(this.#a));const O=(p&&this.#a>=.5?-1:1)*(this.#t<.5?4*this.#t-1:3-4*this.#t),b=2*this.#t-1,j=this.#t<W?-1:1,w=this.#c;a[1][0][e]=0!==P?(m*O+f*b+d*j+R*w)/V:0,this.#s+=16*P,this.#s>=1&&(this.#s-=Math.floor(this.#s),this.#c=2*Math.random()-1),this.#t+=P,this.#t>=1&&(C&&(this.#h=(this.#t-1)/P*y),this.#t-=Math.floor(this.#t));const z=(x&&this.#t>=.5?-1:1)*(this.#h<.5?4*this.#h-1:3-4*this.#h),E=2*this.#h-1,G=this.#h<F?-1:1,H=this.#r;a[2][0][e]=0!==y?(g*z+M*E+S*G+q*H)/B:0,this.#v+=16*y,this.#v>=1&&(this.#v-=Math.floor(this.#v),this.#r=2*Math.random()-1),this.#h+=y,this.#h>=1&&(u&&(this.#a=(this.#h-1)/y*t),this.#h-=Math.floor(this.#h))}return!0}}registerProcessor("C64SidProcessor",C64SidProcessor);